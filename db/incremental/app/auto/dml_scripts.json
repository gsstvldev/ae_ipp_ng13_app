[{
  "key": "215~WFT_NPSS_P_1304_1669177561854_0",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" DELETE FROM QRY_INFO WHERE WFTPA_ID=? AND APP_ID=?\", \"params\" : [\"WFT_NPSS_P_1304_1669177561854_0\", \"215\"] }",
  "qry_type": "D"
},{
  "key": "215~WFT_NPSS_P_1304_1669177561854_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669209378559~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669177561854_0$DQ$,$DQ$DS_1669209378559$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_19$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669177561854_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665903906193~DS_1669178840143~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669177561854_0$DQ$,$DQ$DS_1669178840143$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSSTRRD_ID,        MSG_ID,        UETR,        PARENT_NPSSTRRD_REFNO,        NPSSTRRD_REFNO,        PROCESS_CODE,        PROCESS_DETAIL,        EXHF_ID,        PROCESS_NAME,        MESSAGE_DESC,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        STATUS,        PROCESS_STATUS,        MESSAGE_DATA,        CREATEDDATEMILISEC,        DT_CODE,        DTT_CODE   FROM (SELECT NPSSTRRD.NPSSTRRD_ID,                NPSSTRRD.MSG_ID,                NPSSTRRD.UETR,                NPSSTRRD.PARENT_NPSSTRRD_REFNO,                NPSSTRRD.NPSSTRRD_REFNO,                NPSSTRRD.MESSAGE_DATA,                NPSSTRRD.PROCESS_CODE,                NPSSTRRD.PROCESS_DETAIL,                NPSSTRRD.EXHF_ID,                NPSSTRRD.PROCESS_NAME,                NPSSTRRD.MESSAGE_DESC,                NPSSTRRD.CHANNEL_ID,                NPSSTRRD.CHANNEL_REFNO,                NPSSTRRD.CHANNEL_USERID,                NPSSTRRD.CHANNEL_PRODUCT,                NPSSTRRD.CHANNEL_SUB_PRODUCT,                NPSSTRRD.CHANNEL_TRAN_CODE,                NPSSTRRD.CREATED_BY,                NPSSTRRD.CREATED_BY_NAME,                NPSSTRRD.CREATED_DATE,                NPSSTRRD.DT_CODE,                NPSSTRRD.DT_DESCRIPTION,                NPSSTRRD.DTT_CODE,                NPSSTRRD.DTT_DESCRIPTION,                NPSSTRRD.MODIFIED_BY,                NPSSTRRD.MODIFIED_BY_NAME,                NPSSTRRD.MODIFIED_DATE,                NPSSTRRD.STATUS,                NPSSTRRD.PROCESS_STATUS,                NPSSTRRD.SYSTEM_ID,                NPSSTRRD.SYSTEM_NAME,                NPSSTRRD.TENANT_ID,                NPSSTRRD.APP_ID,                NPSSTRRD.VERSION_NO,                TO_CHAR(NPSSTRRD.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as CREATEDDATEMILISEC           FROM NPSS_TRN_REQ_RESP_DTLS NPSSTRRD) RR $WHERE$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665903906193$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_15$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669177561854_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665905039255~DS_1669179487737~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669177561854_0$DQ$,$DQ$DS_1669179487737$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTPL_ID,        MSG_ID,        UETR,        NPSSTRRD_REFNO,        PROCESS_NAME,        PROCESSING_SYSTEM,        RESPONSE_CODE,        PROCESS_REF_NO,        RESPONSE_DATA,        CREATED_DATE,        CREATEDDATEMILISEC,        PROCESS_STATUS,        STATUS,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        REVERSAL_DESC,        T24_RETURN_DESC,        CBUAE_RETURN_DESC,        TENANT_ID,        DEPARTMENT_CODE,        DT_CODE,        DTT_CODE   FROM (SELECT A.NPSSTPL_ID,                A.MSG_ID,                A.UETR,                A.NPSSTRRD_REFNO,                A.PROCESS_NAME,                A.PROCESSING_SYSTEM,                A.RESPONSE_CODE,                A.PROCESS_REF_NO,                A.RESPONSE_DATA,                TO_CHAR(A.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS CREATEDDATEMILISEC,                A.CREATED_DATE,                A.PROCESS_STATUS,                A.STATUS,                A.DT_CODE,                A.DTT_CODE,                A.TENANT_ID,                A.REQUEST_DATA_JSON,                A.RESPONSE_DATA_JSON,                A.T24_RETURN_CODE,                NT.DEPARTMENT_CODE,                A.ADDITIONAL_INFO,                T24RC.RETURN_DESCRIPTION AS T24_RETURN_DESC,                CONCAT(A.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                A.CBUAE_RETURN_CODE,                CBUAERC.RETURN_DESCRIPTION AS CBUAE_RETURN_DESC,                CONCAT(A.CBUAE_RETURN_CODE, $SQ$-$SQ$, CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                A.REVERSAL_CODE,                CCD.CD_DESCRIPTION AS REVERSAL_DESC,                CONCAT(A.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION           FROM NPSS_TRN_PROCESS_LOG A           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                                   A.REVERSAL_CODE                                                               AND CCD.CD_CATEGORY =                                                                   $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$           LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                                A.T24_RETURN_CODE                                                            AND T24RC.PROCESSING_SYSTEM =                                                                $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$           LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                                  A.CBUAE_RETURN_CODE                                                              AND CBUAERC.PROCESSING_SYSTEM =                                                                  $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$          INNER JOIN NPSS_TRANSACTIONS NT ON NT.UETR = A.UETR          ORDER BY A.NPSSTPL_ID) V $WHERE$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665905039255$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_8$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669177561854_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669179711260~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669177561854_0$DQ$,$DQ$DS_1669179711260$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT PROCESSING_SYSTEM, COUNT(PROCESSING_SYSTEM) AS PS_COUNT   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_NAME,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  GROUP BY PROCESSING_SYSTEM$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_9$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669177561854_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669179871107~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669177561854_0$DQ$,$DQ$DS_1669179871107$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_5$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669177561854_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669179986087~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669177561854_0$DQ$,$DQ$DS_1669179986087$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_4$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669177561854_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669187492810~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669177561854_0$DQ$,$DQ$DS_1669187492810$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ select GROUP_NAME,        INTRBK_STTLM_CUR,        SUM(INTRBK_STTLM_AMNT) as TOTAL_AMOUNT,        COUNT(NPSST_ID) as TOTAL_TRAN_COUNT   from (select NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as DATEMI,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           from NPSS_TRANSACTIONS NT          inner join (select T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       from (select A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    row_number() over(partition by A.UETR order by A.NPSSTPL_ID desc) as ROW_NUM                               from NPSS_TRN_PROCESS_LOG A) T                      inner join <tran_db>.CORE_NC_STATUS_GROUP G on G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       and G.PROCESS_QUEUE_STATUS =                                                           T.STATUS  AND G.STATUS = $SQ$APPROVED$SQ$                      where T.ROW_NUM = 1) NTPL on NT.UETR = NTPL.UETR           left join (select B.NPSSTRRD_ID,                            B.MSG_ID as RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE as RR_DT_CODE,                            B.DTT_CODE as RR_DTT_CODE,                            B.PROCESS_NAME as RR_PROCESS_NAME,                            B.MESSAGE_DESC as RR_MESSAGE_DESC,                            row_number() over(partition by B.UETR order by B.NPSSTRRD_ID desc) as ROW_NUM                       from NPSS_TRN_REQ_RESP_DTLS B) RR on RR.UETR = NT.UETR                                                        and RR.ROW_NUM = 1) V $WHERE  group by GROUP_NAME, INTRBK_STTLM_CUR$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_18$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669177561854_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669179567882~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669177561854_0$DQ$,$DQ$DS_1669179567882$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT GROUP_NAME, GN_SORT_ORDER, COUNT(GROUP_NAME) AS GROUP_COUNT   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                GN_SORT_ORDER           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            CD.SORT_ORDER AS GN_SORT_ORDER                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      INNER JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CD ON CD.CD_CODE =                                                                 G.GROUP_NAME AND CD.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1                        AND CD.CD_CATEGORY = $SQ$STATUS_GROUP$SQ$) NTPL ON NT.UETR =                                                                     NTPL.UETR           LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  GROUP BY GN_SORT_ORDER, GROUP_NAME  ORDER BY GN_SORT_ORDER$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_2$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669461223364_0",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" DELETE FROM QRY_INFO WHERE WFTPA_ID=? AND APP_ID=?\", \"params\" : [\"WFT_NPSS_P_1304_1669461223364_0\", \"215\"] }",
  "qry_type": "D"
},{
  "key": "215~WFT_NPSS_P_1304_1669461223364_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669704499903~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669461223364_0$DQ$,$DQ$DS_1669704499903$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_19$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669461223364_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665905039255~DS_1669703584610~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669461223364_0$DQ$,$DQ$DS_1669703584610$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTPL_ID,        MSG_ID,        UETR,        NPSSTRRD_REFNO,        PROCESS_NAME,        PROCESSING_SYSTEM,        RESPONSE_CODE,        PROCESS_REF_NO,        RESPONSE_DATA,        CREATED_DATE,        CREATEDDATEMILISEC,        PROCESS_STATUS,        STATUS,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        REVERSAL_DESC,        T24_RETURN_DESC,        CBUAE_RETURN_DESC,        TENANT_ID,        DEPARTMENT_CODE,        DT_CODE,        DTT_CODE   FROM (SELECT A.NPSSTPL_ID,                A.MSG_ID,                A.UETR,                A.NPSSTRRD_REFNO,                A.PROCESS_NAME,                A.PROCESSING_SYSTEM,                A.RESPONSE_CODE,                A.PROCESS_REF_NO,                A.RESPONSE_DATA,                TO_CHAR(A.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS CREATEDDATEMILISEC,                A.CREATED_DATE,                A.PROCESS_STATUS,                A.STATUS,                A.DT_CODE,                A.DTT_CODE,                A.TENANT_ID,                A.REQUEST_DATA_JSON,                A.RESPONSE_DATA_JSON,                A.T24_RETURN_CODE,                NT.DEPARTMENT_CODE,                A.ADDITIONAL_INFO,                T24RC.RETURN_DESCRIPTION AS T24_RETURN_DESC,                CONCAT(A.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                A.CBUAE_RETURN_CODE,                CBUAERC.RETURN_DESCRIPTION AS CBUAE_RETURN_DESC,                CONCAT(A.CBUAE_RETURN_CODE, $SQ$-$SQ$, CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                A.REVERSAL_CODE,                CCD.CD_DESCRIPTION AS REVERSAL_DESC,                CONCAT(A.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION           FROM NPSS_TRN_PROCESS_LOG A           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                                   A.REVERSAL_CODE                                                               AND CCD.CD_CATEGORY =                                                                   $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$           LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                                A.T24_RETURN_CODE                                                            AND T24RC.PROCESSING_SYSTEM =                                                                $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$           LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                                  A.CBUAE_RETURN_CODE                                                              AND CBUAERC.PROCESSING_SYSTEM =                                                                  $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$          INNER JOIN NPSS_TRANSACTIONS NT ON NT.UETR = A.UETR          ORDER BY A.NPSSTPL_ID) V $WHERE$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665905039255$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_8$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669461223364_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669703876770~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669461223364_0$DQ$,$DQ$DS_1669703876770$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT GROUP_NAME, GN_SORT_ORDER, COUNT(GROUP_NAME) AS GROUP_COUNT   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                GN_SORT_ORDER           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            CD.SORT_ORDER AS GN_SORT_ORDER                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      INNER JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CD ON CD.CD_CODE =                                                                 G.GROUP_NAME AND CD.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1                        AND CD.CD_CATEGORY = $SQ$STATUS_GROUP$SQ$) NTPL ON NT.UETR =                                                                     NTPL.UETR           LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  GROUP BY GN_SORT_ORDER, GROUP_NAME  ORDER BY GN_SORT_ORDER$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_20$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669461223364_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669704023246~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669461223364_0$DQ$,$DQ$DS_1669704023246$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ select GROUP_NAME,        INTRBK_STTLM_CUR,        SUM(INTRBK_STTLM_AMNT) as TOTAL_AMOUNT,        COUNT(NPSST_ID) as TOTAL_TRAN_COUNT   from (select NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as DATEMI,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           from NPSS_TRANSACTIONS NT          inner join (select T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       from (select A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    row_number() over(partition by A.UETR order by A.NPSSTPL_ID desc) as ROW_NUM                               from NPSS_TRN_PROCESS_LOG A) T                      inner join <tran_db>.CORE_NC_STATUS_GROUP G on G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       and G.PROCESS_QUEUE_STATUS =                                                           T.STATUS  AND G.STATUS = $SQ$APPROVED$SQ$                      where T.ROW_NUM = 1) NTPL on NT.UETR = NTPL.UETR           left join (select B.NPSSTRRD_ID,                            B.MSG_ID as RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE as RR_DT_CODE,                            B.DTT_CODE as RR_DTT_CODE,                            B.PROCESS_NAME as RR_PROCESS_NAME,                            B.MESSAGE_DESC as RR_MESSAGE_DESC,                            row_number() over(partition by B.UETR order by B.NPSSTRRD_ID desc) as ROW_NUM                       from NPSS_TRN_REQ_RESP_DTLS B) RR on RR.UETR = NT.UETR                                                        and RR.ROW_NUM = 1) V $WHERE  group by GROUP_NAME, INTRBK_STTLM_CUR$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_18$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669461223364_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1670072221739~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669461223364_0$DQ$,$DQ$DS_1670072221739$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ select GROUP_NAME,        PROCESS_STATUS,        STATUS,        RULE_GROUP,        SUM(INTRBK_STTLM_AMNT) as TOTAL_AMOUNT,        COUNT(NPSST_ID) as TOTAL_TRAN_COUNT   from (select NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as DATEMI,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           from NPSS_TRANSACTIONS NT          inner join (select T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       from (select A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    row_number() over(partition by A.UETR order by A.NPSSTPL_ID desc) as ROW_NUM                               from NPSS_TRN_PROCESS_LOG A) T                      inner join <tran_db>.CORE_NC_STATUS_GROUP G on G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       and G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      where T.ROW_NUM = 1) NTPL on NT.UETR = NTPL.UETR           left join (select B.NPSSTRRD_ID,                            B.MSG_ID as RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE as RR_DT_CODE,                            B.DTT_CODE as RR_DTT_CODE,                            B.PROCESS_NAME as RR_PROCESS_NAME,                            B.MESSAGE_DESC as RR_MESSAGE_DESC,                            row_number() over(partition by B.UETR order by B.NPSSTRRD_ID desc) as ROW_NUM                       from NPSS_TRN_REQ_RESP_DTLS B) RR on RR.UETR = NT.UETR                                                        and RR.ROW_NUM = 1) V $WHERE  group by GROUP_NAME, RULE_GROUP, PROCESS_STATUS, STATUS$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_25$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669461223364_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669704309081~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669461223364_0$DQ$,$DQ$DS_1669704309081$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_4$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669461223364_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669703710098~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669461223364_0$DQ$,$DQ$DS_1669703710098$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT PROCESSING_SYSTEM, COUNT(PROCESSING_SYSTEM) AS PS_COUNT   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_NAME,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  GROUP BY PROCESSING_SYSTEM$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_21$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669461223364_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669704483714~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669461223364_0$DQ$,$DQ$DS_1669704483714$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_5$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669461223364_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665903906193~DS_1669703656956~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669461223364_0$DQ$,$DQ$DS_1669703656956$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSSTRRD_ID,        MSG_ID,        UETR,        PARENT_NPSSTRRD_REFNO,        NPSSTRRD_REFNO,        PROCESS_CODE,        PROCESS_DETAIL,        EXHF_ID,        PROCESS_NAME,        MESSAGE_DESC,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        STATUS,        PROCESS_STATUS,        MESSAGE_DATA,        CREATEDDATEMILISEC,        DT_CODE,        DTT_CODE   FROM (SELECT NPSSTRRD.NPSSTRRD_ID,                NPSSTRRD.MSG_ID,                NPSSTRRD.UETR,                NPSSTRRD.PARENT_NPSSTRRD_REFNO,                NPSSTRRD.NPSSTRRD_REFNO,                NPSSTRRD.MESSAGE_DATA,                NPSSTRRD.PROCESS_CODE,                NPSSTRRD.PROCESS_DETAIL,                NPSSTRRD.EXHF_ID,                NPSSTRRD.PROCESS_NAME,                NPSSTRRD.MESSAGE_DESC,                NPSSTRRD.CHANNEL_ID,                NPSSTRRD.CHANNEL_REFNO,                NPSSTRRD.CHANNEL_USERID,                NPSSTRRD.CHANNEL_PRODUCT,                NPSSTRRD.CHANNEL_SUB_PRODUCT,                NPSSTRRD.CHANNEL_TRAN_CODE,                NPSSTRRD.CREATED_BY,                NPSSTRRD.CREATED_BY_NAME,                NPSSTRRD.CREATED_DATE,                NPSSTRRD.DT_CODE,                NPSSTRRD.DT_DESCRIPTION,                NPSSTRRD.DTT_CODE,                NPSSTRRD.DTT_DESCRIPTION,                NPSSTRRD.MODIFIED_BY,                NPSSTRRD.MODIFIED_BY_NAME,                NPSSTRRD.MODIFIED_DATE,                NPSSTRRD.STATUS,                NPSSTRRD.PROCESS_STATUS,                NPSSTRRD.SYSTEM_ID,                NPSSTRRD.SYSTEM_NAME,                NPSSTRRD.TENANT_ID,                NPSSTRRD.APP_ID,                NPSSTRRD.VERSION_NO,                TO_CHAR(NPSSTRRD.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as CREATEDDATEMILISEC           FROM NPSS_TRN_REQ_RESP_DTLS NPSSTRRD) RR $WHERE$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665903906193$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_15$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669529716897_0",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" DELETE FROM QRY_INFO WHERE WFTPA_ID=? AND APP_ID=?\", \"params\" : [\"WFT_NPSS_P_1304_1669529716897_0\", \"215\"] }",
  "qry_type": "D"
},{
  "key": "215~WFT_NPSS_P_1304_1669529716897_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1670075223070~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669529716897_0$DQ$,$DQ$DS_1670075223070$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ select GROUP_NAME,        PROCESS_STATUS,        STATUS,        RULE_GROUP,        SUM(INTRBK_STTLM_AMNT) as TOTAL_AMOUNT,        COUNT(NPSST_ID) as TOTAL_TRAN_COUNT   from (select NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as DATEMI,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           from NPSS_TRANSACTIONS NT          inner join (select T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       from (select A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    row_number() over(partition by A.UETR order by A.NPSSTPL_ID desc) as ROW_NUM                               from NPSS_TRN_PROCESS_LOG A) T                      inner join <tran_db>.CORE_NC_STATUS_GROUP G on G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       and G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      where T.ROW_NUM = 1) NTPL on NT.UETR = NTPL.UETR           left join (select B.NPSSTRRD_ID,                            B.MSG_ID as RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE as RR_DT_CODE,                            B.DTT_CODE as RR_DTT_CODE,                            B.PROCESS_NAME as RR_PROCESS_NAME,                            B.MESSAGE_DESC as RR_MESSAGE_DESC,                            row_number() over(partition by B.UETR order by B.NPSSTRRD_ID desc) as ROW_NUM                       from NPSS_TRN_REQ_RESP_DTLS B) RR on RR.UETR = NT.UETR                                                        and RR.ROW_NUM = 1) V $WHERE  group by GROUP_NAME, RULE_GROUP, PROCESS_STATUS, STATUS$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_25$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669529716897_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669648255798~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669529716897_0$DQ$,$DQ$DS_1669648255798$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_5$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669529716897_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669647938467~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669529716897_0$DQ$,$DQ$DS_1669647938467$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ select GROUP_NAME,        INTRBK_STTLM_CUR,        SUM(INTRBK_STTLM_AMNT) as TOTAL_AMOUNT,        COUNT(NPSST_ID) as TOTAL_TRAN_COUNT   from (select NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as DATEMI,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           from NPSS_TRANSACTIONS NT          inner join (select T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       from (select A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    row_number() over(partition by A.UETR order by A.NPSSTPL_ID desc) as ROW_NUM                               from NPSS_TRN_PROCESS_LOG A) T                      inner join <tran_db>.CORE_NC_STATUS_GROUP G on G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       and G.PROCESS_QUEUE_STATUS =                                                           T.STATUS  AND G.STATUS = $SQ$APPROVED$SQ$                      where T.ROW_NUM = 1) NTPL on NT.UETR = NTPL.UETR           left join (select B.NPSSTRRD_ID,                            B.MSG_ID as RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE as RR_DT_CODE,                            B.DTT_CODE as RR_DTT_CODE,                            B.PROCESS_NAME as RR_PROCESS_NAME,                            B.MESSAGE_DESC as RR_MESSAGE_DESC,                            row_number() over(partition by B.UETR order by B.NPSSTRRD_ID desc) as ROW_NUM                       from NPSS_TRN_REQ_RESP_DTLS B) RR on RR.UETR = NT.UETR                                                        and RR.ROW_NUM = 1) V $WHERE  group by GROUP_NAME, INTRBK_STTLM_CUR$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_18$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669529716897_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669648311899~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669529716897_0$DQ$,$DQ$DS_1669648311899$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_19$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669529716897_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669647824185~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669529716897_0$DQ$,$DQ$DS_1669647824185$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT GROUP_NAME, GN_SORT_ORDER, COUNT(GROUP_NAME) AS GROUP_COUNT   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                GN_SORT_ORDER           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            CD.SORT_ORDER AS GN_SORT_ORDER                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      INNER JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CD ON CD.CD_CODE =                                                                 G.GROUP_NAME AND CD.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1                        AND CD.CD_CATEGORY = $SQ$STATUS_GROUP$SQ$) NTPL ON NT.UETR =                                                                     NTPL.UETR           LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  GROUP BY GN_SORT_ORDER, GROUP_NAME  ORDER BY GN_SORT_ORDER$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_20$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669529716897_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669648075325~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669529716897_0$DQ$,$DQ$DS_1669648075325$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_4$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669529716897_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669647692918~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669529716897_0$DQ$,$DQ$DS_1669647692918$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT PROCESSING_SYSTEM, COUNT(PROCESSING_SYSTEM) AS PS_COUNT   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_NAME,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  GROUP BY PROCESSING_SYSTEM$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_21$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669529716897_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665905039255~DS_1669647617593~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669529716897_0$DQ$,$DQ$DS_1669647617593$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTPL_ID,        MSG_ID,        UETR,        NPSSTRRD_REFNO,        PROCESS_NAME,        PROCESSING_SYSTEM,        RESPONSE_CODE,        PROCESS_REF_NO,        RESPONSE_DATA,        CREATED_DATE,        CREATEDDATEMILISEC,        PROCESS_STATUS,        STATUS,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        REVERSAL_DESC,        T24_RETURN_DESC,        CBUAE_RETURN_DESC,        TENANT_ID,        DEPARTMENT_CODE,        DT_CODE,        DTT_CODE   FROM (SELECT A.NPSSTPL_ID,                A.MSG_ID,                A.UETR,                A.NPSSTRRD_REFNO,                A.PROCESS_NAME,                A.PROCESSING_SYSTEM,                A.RESPONSE_CODE,                A.PROCESS_REF_NO,                A.RESPONSE_DATA,                TO_CHAR(A.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS CREATEDDATEMILISEC,                A.CREATED_DATE,                A.PROCESS_STATUS,                A.STATUS,                A.DT_CODE,                A.DTT_CODE,                A.TENANT_ID,                A.REQUEST_DATA_JSON,                A.RESPONSE_DATA_JSON,                A.T24_RETURN_CODE,                NT.DEPARTMENT_CODE,                A.ADDITIONAL_INFO,                T24RC.RETURN_DESCRIPTION AS T24_RETURN_DESC,                CONCAT(A.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                A.CBUAE_RETURN_CODE,                CBUAERC.RETURN_DESCRIPTION AS CBUAE_RETURN_DESC,                CONCAT(A.CBUAE_RETURN_CODE, $SQ$-$SQ$, CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                A.REVERSAL_CODE,                CCD.CD_DESCRIPTION AS REVERSAL_DESC,                CONCAT(A.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION           FROM NPSS_TRN_PROCESS_LOG A           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                                   A.REVERSAL_CODE                                                               AND CCD.CD_CATEGORY =                                                                   $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$           LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                                A.T24_RETURN_CODE                                                            AND T24RC.PROCESSING_SYSTEM =                                                                $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$           LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                                  A.CBUAE_RETURN_CODE                                                              AND CBUAERC.PROCESSING_SYSTEM =                                                                  $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$          INNER JOIN NPSS_TRANSACTIONS NT ON NT.UETR = A.UETR          ORDER BY A.NPSSTPL_ID) V $WHERE$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665905039255$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_8$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669699780325_0",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" DELETE FROM QRY_INFO WHERE WFTPA_ID=? AND APP_ID=?\", \"params\" : [\"WFT_NPSS_P_1304_1669699780325_0\", \"215\"] }",
  "qry_type": "D"
},{
  "key": "215~WFT_NPSS_P_1304_1669699780325_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669707718121~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669699780325_0$DQ$,$DQ$DS_1669707718121$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_19$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669699780325_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669707338146~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669699780325_0$DQ$,$DQ$DS_1669707338146$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ select GROUP_NAME,        INTRBK_STTLM_CUR,        SUM(INTRBK_STTLM_AMNT) as TOTAL_AMOUNT,        COUNT(NPSST_ID) as TOTAL_TRAN_COUNT   from (select NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as DATEMI,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           from NPSS_TRANSACTIONS NT          inner join (select T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       from (select A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    row_number() over(partition by A.UETR order by A.NPSSTPL_ID desc) as ROW_NUM                               from NPSS_TRN_PROCESS_LOG A) T                      inner join <tran_db>.CORE_NC_STATUS_GROUP G on G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       and G.PROCESS_QUEUE_STATUS =                                                           T.STATUS  AND G.STATUS = $SQ$APPROVED$SQ$                      where T.ROW_NUM = 1) NTPL on NT.UETR = NTPL.UETR           left join (select B.NPSSTRRD_ID,                            B.MSG_ID as RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE as RR_DT_CODE,                            B.DTT_CODE as RR_DTT_CODE,                            B.PROCESS_NAME as RR_PROCESS_NAME,                            B.MESSAGE_DESC as RR_MESSAGE_DESC,                            row_number() over(partition by B.UETR order by B.NPSSTRRD_ID desc) as ROW_NUM                       from NPSS_TRN_REQ_RESP_DTLS B) RR on RR.UETR = NT.UETR                                                        and RR.ROW_NUM = 1) V $WHERE  group by GROUP_NAME, INTRBK_STTLM_CUR$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_18$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669699780325_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669707094912~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669699780325_0$DQ$,$DQ$DS_1669707094912$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT GROUP_NAME, GN_SORT_ORDER, COUNT(GROUP_NAME) AS GROUP_COUNT   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                GN_SORT_ORDER           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            CD.SORT_ORDER AS GN_SORT_ORDER                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      INNER JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CD ON CD.CD_CODE =                                                                 G.GROUP_NAME AND CD.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1                        AND CD.CD_CATEGORY = $SQ$STATUS_GROUP$SQ$) NTPL ON NT.UETR =                                                                     NTPL.UETR           LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  GROUP BY GN_SORT_ORDER, GROUP_NAME  ORDER BY GN_SORT_ORDER$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_20$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669699780325_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665905039255~DS_1669706723151~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669699780325_0$DQ$,$DQ$DS_1669706723151$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTPL_ID,        MSG_ID,        UETR,        NPSSTRRD_REFNO,        PROCESS_NAME,        PROCESSING_SYSTEM,        RESPONSE_CODE,        PROCESS_REF_NO,        RESPONSE_DATA,        CREATED_DATE,        CREATEDDATEMILISEC,        PROCESS_STATUS,        STATUS,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        REVERSAL_DESC,        T24_RETURN_DESC,        CBUAE_RETURN_DESC,        TENANT_ID,        DEPARTMENT_CODE,        DT_CODE,        DTT_CODE   FROM (SELECT A.NPSSTPL_ID,                A.MSG_ID,                A.UETR,                A.NPSSTRRD_REFNO,                A.PROCESS_NAME,                A.PROCESSING_SYSTEM,                A.RESPONSE_CODE,                A.PROCESS_REF_NO,                A.RESPONSE_DATA,                TO_CHAR(A.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS CREATEDDATEMILISEC,                A.CREATED_DATE,                A.PROCESS_STATUS,                A.STATUS,                A.DT_CODE,                A.DTT_CODE,                A.TENANT_ID,                A.REQUEST_DATA_JSON,                A.RESPONSE_DATA_JSON,                A.T24_RETURN_CODE,                NT.DEPARTMENT_CODE,                A.ADDITIONAL_INFO,                T24RC.RETURN_DESCRIPTION AS T24_RETURN_DESC,                CONCAT(A.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                A.CBUAE_RETURN_CODE,                CBUAERC.RETURN_DESCRIPTION AS CBUAE_RETURN_DESC,                CONCAT(A.CBUAE_RETURN_CODE, $SQ$-$SQ$, CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                A.REVERSAL_CODE,                CCD.CD_DESCRIPTION AS REVERSAL_DESC,                CONCAT(A.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION           FROM NPSS_TRN_PROCESS_LOG A           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                                   A.REVERSAL_CODE                                                               AND CCD.CD_CATEGORY =                                                                   $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$           LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                                A.T24_RETURN_CODE                                                            AND T24RC.PROCESSING_SYSTEM =                                                                $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$           LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                                  A.CBUAE_RETURN_CODE                                                              AND CBUAERC.PROCESSING_SYSTEM =                                                                  $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$          INNER JOIN NPSS_TRANSACTIONS NT ON NT.UETR = A.UETR          ORDER BY A.NPSSTPL_ID) V $WHERE$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665905039255$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_8$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669699780325_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669706848972~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669699780325_0$DQ$,$DQ$DS_1669706848972$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT PROCESSING_SYSTEM, COUNT(PROCESSING_SYSTEM) AS PS_COUNT   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_NAME,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  GROUP BY PROCESSING_SYSTEM$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_21$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669699780325_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665903906193~DS_1669706786353~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669699780325_0$DQ$,$DQ$DS_1669706786353$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSSTRRD_ID,        MSG_ID,        UETR,        PARENT_NPSSTRRD_REFNO,        NPSSTRRD_REFNO,        PROCESS_CODE,        PROCESS_DETAIL,        EXHF_ID,        PROCESS_NAME,        MESSAGE_DESC,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        STATUS,        PROCESS_STATUS,        MESSAGE_DATA,        CREATEDDATEMILISEC,        DT_CODE,        DTT_CODE   FROM (SELECT NPSSTRRD.NPSSTRRD_ID,                NPSSTRRD.MSG_ID,                NPSSTRRD.UETR,                NPSSTRRD.PARENT_NPSSTRRD_REFNO,                NPSSTRRD.NPSSTRRD_REFNO,                NPSSTRRD.MESSAGE_DATA,                NPSSTRRD.PROCESS_CODE,                NPSSTRRD.PROCESS_DETAIL,                NPSSTRRD.EXHF_ID,                NPSSTRRD.PROCESS_NAME,                NPSSTRRD.MESSAGE_DESC,                NPSSTRRD.CHANNEL_ID,                NPSSTRRD.CHANNEL_REFNO,                NPSSTRRD.CHANNEL_USERID,                NPSSTRRD.CHANNEL_PRODUCT,                NPSSTRRD.CHANNEL_SUB_PRODUCT,                NPSSTRRD.CHANNEL_TRAN_CODE,                NPSSTRRD.CREATED_BY,                NPSSTRRD.CREATED_BY_NAME,                NPSSTRRD.CREATED_DATE,                NPSSTRRD.DT_CODE,                NPSSTRRD.DT_DESCRIPTION,                NPSSTRRD.DTT_CODE,                NPSSTRRD.DTT_DESCRIPTION,                NPSSTRRD.MODIFIED_BY,                NPSSTRRD.MODIFIED_BY_NAME,                NPSSTRRD.MODIFIED_DATE,                NPSSTRRD.STATUS,                NPSSTRRD.PROCESS_STATUS,                NPSSTRRD.SYSTEM_ID,                NPSSTRRD.SYSTEM_NAME,                NPSSTRRD.TENANT_ID,                NPSSTRRD.APP_ID,                NPSSTRRD.VERSION_NO,                TO_CHAR(NPSSTRRD.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as CREATEDDATEMILISEC           FROM NPSS_TRN_REQ_RESP_DTLS NPSSTRRD) RR $WHERE$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665903906193$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_15$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669699780325_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1670072332245~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669699780325_0$DQ$,$DQ$DS_1670072332245$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ select GROUP_NAME,        PROCESS_STATUS,        STATUS,        RULE_GROUP,        SUM(INTRBK_STTLM_AMNT) as TOTAL_AMOUNT,        COUNT(NPSST_ID) as TOTAL_TRAN_COUNT   from (select NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as DATEMI,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           from NPSS_TRANSACTIONS NT          inner join (select T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       from (select A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    row_number() over(partition by A.UETR order by A.NPSSTPL_ID desc) as ROW_NUM                               from NPSS_TRN_PROCESS_LOG A) T                      inner join <tran_db>.CORE_NC_STATUS_GROUP G on G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       and G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      where T.ROW_NUM = 1) NTPL on NT.UETR = NTPL.UETR           left join (select B.NPSSTRRD_ID,                            B.MSG_ID as RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE as RR_DT_CODE,                            B.DTT_CODE as RR_DTT_CODE,                            B.PROCESS_NAME as RR_PROCESS_NAME,                            B.MESSAGE_DESC as RR_MESSAGE_DESC,                            row_number() over(partition by B.UETR order by B.NPSSTRRD_ID desc) as ROW_NUM                       from NPSS_TRN_REQ_RESP_DTLS B) RR on RR.UETR = NT.UETR                                                        and RR.ROW_NUM = 1) V $WHERE  group by GROUP_NAME, RULE_GROUP, PROCESS_STATUS, STATUS$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_25$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669699780325_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669707691434~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669699780325_0$DQ$,$DQ$DS_1669707691434$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_5$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669699780325_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669707528555~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669699780325_0$DQ$,$DQ$DS_1669707528555$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_4$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669700041165_0",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" DELETE FROM QRY_INFO WHERE WFTPA_ID=? AND APP_ID=?\", \"params\" : [\"WFT_NPSS_P_1304_1669700041165_0\", \"215\"] }",
  "qry_type": "D"
},{
  "key": "215~WFT_NPSS_P_1304_1669700041165_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669705045015~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669700041165_0$DQ$,$DQ$DS_1669705045015$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT GROUP_NAME, GN_SORT_ORDER, COUNT(GROUP_NAME) AS GROUP_COUNT   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                GN_SORT_ORDER           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            CD.SORT_ORDER AS GN_SORT_ORDER                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      INNER JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CD ON CD.CD_CODE =                                                                 G.GROUP_NAME AND CD.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1                        AND CD.CD_CATEGORY = $SQ$STATUS_GROUP$SQ$) NTPL ON NT.UETR =                                                                     NTPL.UETR           LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  GROUP BY GN_SORT_ORDER, GROUP_NAME  ORDER BY GN_SORT_ORDER$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_20$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669700041165_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665903906193~DS_1669704776203~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669700041165_0$DQ$,$DQ$DS_1669704776203$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSSTRRD_ID,        MSG_ID,        UETR,        PARENT_NPSSTRRD_REFNO,        NPSSTRRD_REFNO,        PROCESS_CODE,        PROCESS_DETAIL,        EXHF_ID,        PROCESS_NAME,        MESSAGE_DESC,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        STATUS,        PROCESS_STATUS,        MESSAGE_DATA,        CREATEDDATEMILISEC,        DT_CODE,        DTT_CODE   FROM (SELECT NPSSTRRD.NPSSTRRD_ID,                NPSSTRRD.MSG_ID,                NPSSTRRD.UETR,                NPSSTRRD.PARENT_NPSSTRRD_REFNO,                NPSSTRRD.NPSSTRRD_REFNO,                NPSSTRRD.MESSAGE_DATA,                NPSSTRRD.PROCESS_CODE,                NPSSTRRD.PROCESS_DETAIL,                NPSSTRRD.EXHF_ID,                NPSSTRRD.PROCESS_NAME,                NPSSTRRD.MESSAGE_DESC,                NPSSTRRD.CHANNEL_ID,                NPSSTRRD.CHANNEL_REFNO,                NPSSTRRD.CHANNEL_USERID,                NPSSTRRD.CHANNEL_PRODUCT,                NPSSTRRD.CHANNEL_SUB_PRODUCT,                NPSSTRRD.CHANNEL_TRAN_CODE,                NPSSTRRD.CREATED_BY,                NPSSTRRD.CREATED_BY_NAME,                NPSSTRRD.CREATED_DATE,                NPSSTRRD.DT_CODE,                NPSSTRRD.DT_DESCRIPTION,                NPSSTRRD.DTT_CODE,                NPSSTRRD.DTT_DESCRIPTION,                NPSSTRRD.MODIFIED_BY,                NPSSTRRD.MODIFIED_BY_NAME,                NPSSTRRD.MODIFIED_DATE,                NPSSTRRD.STATUS,                NPSSTRRD.PROCESS_STATUS,                NPSSTRRD.SYSTEM_ID,                NPSSTRRD.SYSTEM_NAME,                NPSSTRRD.TENANT_ID,                NPSSTRRD.APP_ID,                NPSSTRRD.VERSION_NO,                TO_CHAR(NPSSTRRD.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as CREATEDDATEMILISEC           FROM NPSS_TRN_REQ_RESP_DTLS NPSSTRRD) RR $WHERE$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665903906193$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_15$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669700041165_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1670072438623~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669700041165_0$DQ$,$DQ$DS_1670072438623$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ select GROUP_NAME,        PROCESS_STATUS,        STATUS,        RULE_GROUP,        SUM(INTRBK_STTLM_AMNT) as TOTAL_AMOUNT,        COUNT(NPSST_ID) as TOTAL_TRAN_COUNT   from (select NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as DATEMI,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           from NPSS_TRANSACTIONS NT          inner join (select T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       from (select A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    row_number() over(partition by A.UETR order by A.NPSSTPL_ID desc) as ROW_NUM                               from NPSS_TRN_PROCESS_LOG A) T                      inner join <tran_db>.CORE_NC_STATUS_GROUP G on G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       and G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      where T.ROW_NUM = 1) NTPL on NT.UETR = NTPL.UETR           left join (select B.NPSSTRRD_ID,                            B.MSG_ID as RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE as RR_DT_CODE,                            B.DTT_CODE as RR_DTT_CODE,                            B.PROCESS_NAME as RR_PROCESS_NAME,                            B.MESSAGE_DESC as RR_MESSAGE_DESC,                            row_number() over(partition by B.UETR order by B.NPSSTRRD_ID desc) as ROW_NUM                       from NPSS_TRN_REQ_RESP_DTLS B) RR on RR.UETR = NT.UETR                                                        and RR.ROW_NUM = 1) V $WHERE  group by GROUP_NAME, RULE_GROUP, PROCESS_STATUS, STATUS$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_25$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669700041165_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669705567777~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669700041165_0$DQ$,$DQ$DS_1669705567777$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_19$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669700041165_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669705210941~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669700041165_0$DQ$,$DQ$DS_1669705210941$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ select GROUP_NAME,        INTRBK_STTLM_CUR,        SUM(INTRBK_STTLM_AMNT) as TOTAL_AMOUNT,        COUNT(NPSST_ID) as TOTAL_TRAN_COUNT   from (select NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as DATEMI,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           from NPSS_TRANSACTIONS NT          inner join (select T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       from (select A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    row_number() over(partition by A.UETR order by A.NPSSTPL_ID desc) as ROW_NUM                               from NPSS_TRN_PROCESS_LOG A) T                      inner join <tran_db>.CORE_NC_STATUS_GROUP G on G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       and G.PROCESS_QUEUE_STATUS =                                                           T.STATUS  AND G.STATUS = $SQ$APPROVED$SQ$                      where T.ROW_NUM = 1) NTPL on NT.UETR = NTPL.UETR           left join (select B.NPSSTRRD_ID,                            B.MSG_ID as RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE as RR_DT_CODE,                            B.DTT_CODE as RR_DTT_CODE,                            B.PROCESS_NAME as RR_PROCESS_NAME,                            B.MESSAGE_DESC as RR_MESSAGE_DESC,                            row_number() over(partition by B.UETR order by B.NPSSTRRD_ID desc) as ROW_NUM                       from NPSS_TRN_REQ_RESP_DTLS B) RR on RR.UETR = NT.UETR                                                        and RR.ROW_NUM = 1) V $WHERE  group by GROUP_NAME, INTRBK_STTLM_CUR$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_18$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669700041165_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665905039255~DS_1669704731815~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669700041165_0$DQ$,$DQ$DS_1669704731815$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTPL_ID,        MSG_ID,        UETR,        NPSSTRRD_REFNO,        PROCESS_NAME,        PROCESSING_SYSTEM,        RESPONSE_CODE,        PROCESS_REF_NO,        RESPONSE_DATA,        CREATED_DATE,        CREATEDDATEMILISEC,        PROCESS_STATUS,        STATUS,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        REVERSAL_DESC,        T24_RETURN_DESC,        CBUAE_RETURN_DESC,        TENANT_ID,        DEPARTMENT_CODE,        DT_CODE,        DTT_CODE   FROM (SELECT A.NPSSTPL_ID,                A.MSG_ID,                A.UETR,                A.NPSSTRRD_REFNO,                A.PROCESS_NAME,                A.PROCESSING_SYSTEM,                A.RESPONSE_CODE,                A.PROCESS_REF_NO,                A.RESPONSE_DATA,                TO_CHAR(A.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS CREATEDDATEMILISEC,                A.CREATED_DATE,                A.PROCESS_STATUS,                A.STATUS,                A.DT_CODE,                A.DTT_CODE,                A.TENANT_ID,                A.REQUEST_DATA_JSON,                A.RESPONSE_DATA_JSON,                A.T24_RETURN_CODE,                NT.DEPARTMENT_CODE,                A.ADDITIONAL_INFO,                T24RC.RETURN_DESCRIPTION AS T24_RETURN_DESC,                CONCAT(A.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                A.CBUAE_RETURN_CODE,                CBUAERC.RETURN_DESCRIPTION AS CBUAE_RETURN_DESC,                CONCAT(A.CBUAE_RETURN_CODE, $SQ$-$SQ$, CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                A.REVERSAL_CODE,                CCD.CD_DESCRIPTION AS REVERSAL_DESC,                CONCAT(A.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION           FROM NPSS_TRN_PROCESS_LOG A           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                                   A.REVERSAL_CODE                                                               AND CCD.CD_CATEGORY =                                                                   $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$           LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                                A.T24_RETURN_CODE                                                            AND T24RC.PROCESSING_SYSTEM =                                                                $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$           LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                                  A.CBUAE_RETURN_CODE                                                              AND CBUAERC.PROCESSING_SYSTEM =                                                                  $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$          INNER JOIN NPSS_TRANSACTIONS NT ON NT.UETR = A.UETR          ORDER BY A.NPSSTPL_ID) V $WHERE$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665905039255$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_8$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669700041165_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669704864826~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669700041165_0$DQ$,$DQ$DS_1669704864826$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT PROCESSING_SYSTEM, COUNT(PROCESSING_SYSTEM) AS PS_COUNT   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_NAME,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  GROUP BY PROCESSING_SYSTEM$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_21$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669700041165_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669705379987~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669700041165_0$DQ$,$DQ$DS_1669705379987$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_4$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669700041165_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669705548318~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669700041165_0$DQ$,$DQ$DS_1669705548318$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_5$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669786991158_0",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" DELETE FROM QRY_INFO WHERE WFTPA_ID=? AND APP_ID=?\", \"params\" : [\"WFT_NPSS_P_1304_1669786991158_0\", \"215\"] }",
  "qry_type": "D"
},{
  "key": "215~WFT_NPSS_P_1304_1669786991158_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665905039255~DS_1669793474591~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669786991158_0$DQ$,$DQ$DS_1669793474591$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTPL_ID,        MSG_ID,        UETR,        NPSSTRRD_REFNO,        PROCESS_NAME,        PROCESSING_SYSTEM,        RESPONSE_CODE,        PROCESS_REF_NO,        RESPONSE_DATA,        CREATED_DATE,        CREATEDDATEMILISEC,        PROCESS_STATUS,        STATUS,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        REVERSAL_DESC,        T24_RETURN_DESC,        CBUAE_RETURN_DESC,        TENANT_ID,        DEPARTMENT_CODE,        DT_CODE,        DTT_CODE   FROM (SELECT A.NPSSTPL_ID,                A.MSG_ID,                A.UETR,                A.NPSSTRRD_REFNO,                A.PROCESS_NAME,                A.PROCESSING_SYSTEM,                A.RESPONSE_CODE,                A.PROCESS_REF_NO,                A.RESPONSE_DATA,                TO_CHAR(A.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS CREATEDDATEMILISEC,                A.CREATED_DATE,                A.PROCESS_STATUS,                A.STATUS,                A.DT_CODE,                A.DTT_CODE,                A.TENANT_ID,                A.REQUEST_DATA_JSON,                A.RESPONSE_DATA_JSON,                A.T24_RETURN_CODE,                NT.DEPARTMENT_CODE,                A.ADDITIONAL_INFO,                T24RC.RETURN_DESCRIPTION AS T24_RETURN_DESC,                CONCAT(A.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                A.CBUAE_RETURN_CODE,                CBUAERC.RETURN_DESCRIPTION AS CBUAE_RETURN_DESC,                CONCAT(A.CBUAE_RETURN_CODE, $SQ$-$SQ$, CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                A.REVERSAL_CODE,                CCD.CD_DESCRIPTION AS REVERSAL_DESC,                CONCAT(A.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION           FROM NPSS_TRN_PROCESS_LOG A           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                                   A.REVERSAL_CODE                                                               AND CCD.CD_CATEGORY =                                                                   $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$           LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                                A.T24_RETURN_CODE                                                            AND T24RC.PROCESSING_SYSTEM =                                                                $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$           LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                                  A.CBUAE_RETURN_CODE                                                              AND CBUAERC.PROCESSING_SYSTEM =                                                                  $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$          INNER JOIN NPSS_TRANSACTIONS NT ON NT.UETR = A.UETR          ORDER BY A.NPSSTPL_ID) V $WHERE$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665905039255$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_8$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669786991158_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669794162068~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669786991158_0$DQ$,$DQ$DS_1669794162068$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_4$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669786991158_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669794340012~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669786991158_0$DQ$,$DQ$DS_1669794340012$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_19$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669786991158_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665903906193~DS_1669793530122~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669786991158_0$DQ$,$DQ$DS_1669793530122$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSSTRRD_ID,        MSG_ID,        UETR,        PARENT_NPSSTRRD_REFNO,        NPSSTRRD_REFNO,        PROCESS_CODE,        PROCESS_DETAIL,        EXHF_ID,        PROCESS_NAME,        MESSAGE_DESC,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        STATUS,        PROCESS_STATUS,        MESSAGE_DATA,        CREATEDDATEMILISEC,        DT_CODE,        DTT_CODE   FROM (SELECT NPSSTRRD.NPSSTRRD_ID,                NPSSTRRD.MSG_ID,                NPSSTRRD.UETR,                NPSSTRRD.PARENT_NPSSTRRD_REFNO,                NPSSTRRD.NPSSTRRD_REFNO,                NPSSTRRD.MESSAGE_DATA,                NPSSTRRD.PROCESS_CODE,                NPSSTRRD.PROCESS_DETAIL,                NPSSTRRD.EXHF_ID,                NPSSTRRD.PROCESS_NAME,                NPSSTRRD.MESSAGE_DESC,                NPSSTRRD.CHANNEL_ID,                NPSSTRRD.CHANNEL_REFNO,                NPSSTRRD.CHANNEL_USERID,                NPSSTRRD.CHANNEL_PRODUCT,                NPSSTRRD.CHANNEL_SUB_PRODUCT,                NPSSTRRD.CHANNEL_TRAN_CODE,                NPSSTRRD.CREATED_BY,                NPSSTRRD.CREATED_BY_NAME,                NPSSTRRD.CREATED_DATE,                NPSSTRRD.DT_CODE,                NPSSTRRD.DT_DESCRIPTION,                NPSSTRRD.DTT_CODE,                NPSSTRRD.DTT_DESCRIPTION,                NPSSTRRD.MODIFIED_BY,                NPSSTRRD.MODIFIED_BY_NAME,                NPSSTRRD.MODIFIED_DATE,                NPSSTRRD.STATUS,                NPSSTRRD.PROCESS_STATUS,                NPSSTRRD.SYSTEM_ID,                NPSSTRRD.SYSTEM_NAME,                NPSSTRRD.TENANT_ID,                NPSSTRRD.APP_ID,                NPSSTRRD.VERSION_NO,                TO_CHAR(NPSSTRRD.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as CREATEDDATEMILISEC           FROM NPSS_TRN_REQ_RESP_DTLS NPSSTRRD) RR $WHERE$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665903906193$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_15$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669786991158_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669793990530~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669786991158_0$DQ$,$DQ$DS_1669793990530$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ select GROUP_NAME,        INTRBK_STTLM_CUR,        SUM(INTRBK_STTLM_AMNT) as TOTAL_AMOUNT,        COUNT(NPSST_ID) as TOTAL_TRAN_COUNT   from (select NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as DATEMI,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           from NPSS_TRANSACTIONS NT          inner join (select T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       from (select A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    row_number() over(partition by A.UETR order by A.NPSSTPL_ID desc) as ROW_NUM                               from NPSS_TRN_PROCESS_LOG A) T                      inner join <tran_db>.CORE_NC_STATUS_GROUP G on G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       and G.PROCESS_QUEUE_STATUS =                                                           T.STATUS  AND G.STATUS = $SQ$APPROVED$SQ$                      where T.ROW_NUM = 1) NTPL on NT.UETR = NTPL.UETR           left join (select B.NPSSTRRD_ID,                            B.MSG_ID as RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE as RR_DT_CODE,                            B.DTT_CODE as RR_DTT_CODE,                            B.PROCESS_NAME as RR_PROCESS_NAME,                            B.MESSAGE_DESC as RR_MESSAGE_DESC,                            row_number() over(partition by B.UETR order by B.NPSSTRRD_ID desc) as ROW_NUM                       from NPSS_TRN_REQ_RESP_DTLS B) RR on RR.UETR = NT.UETR                                                        and RR.ROW_NUM = 1) V $WHERE  group by GROUP_NAME, INTRBK_STTLM_CUR$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_18$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669786991158_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669794317910~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669786991158_0$DQ$,$DQ$DS_1669794317910$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_5$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669786991158_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669793900718~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669786991158_0$DQ$,$DQ$DS_1669793900718$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT GROUP_NAME, GN_SORT_ORDER, COUNT(GROUP_NAME) AS GROUP_COUNT   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                GN_SORT_ORDER           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            CD.SORT_ORDER AS GN_SORT_ORDER                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      INNER JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CD ON CD.CD_CODE =                                                                 G.GROUP_NAME AND CD.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1                        AND CD.CD_CATEGORY = $SQ$STATUS_GROUP$SQ$) NTPL ON NT.UETR =                                                                     NTPL.UETR           LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  GROUP BY GN_SORT_ORDER, GROUP_NAME  ORDER BY GN_SORT_ORDER$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_2$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669786991158_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669793584691~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669786991158_0$DQ$,$DQ$DS_1669793584691$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT PROCESSING_SYSTEM, COUNT(PROCESSING_SYSTEM) AS PS_COUNT   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_NAME,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  GROUP BY PROCESSING_SYSTEM$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_9$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669787086577_0",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" DELETE FROM QRY_INFO WHERE WFTPA_ID=? AND APP_ID=?\", \"params\" : [\"WFT_NPSS_P_1304_1669787086577_0\", \"215\"] }",
  "qry_type": "D"
},{
  "key": "215~WFT_NPSS_P_1304_1669787086577_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669789068167~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669787086577_0$DQ$,$DQ$DS_1669789068167$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT PROCESSING_SYSTEM, COUNT(PROCESSING_SYSTEM) AS PS_COUNT   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_NAME,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  GROUP BY PROCESSING_SYSTEM$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_9$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669787086577_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669791943462~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669787086577_0$DQ$,$DQ$DS_1669791943462$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_19$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669787086577_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669791317235~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669787086577_0$DQ$,$DQ$DS_1669791317235$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_4$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669787086577_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665905039255~DS_1669788953179~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669787086577_0$DQ$,$DQ$DS_1669788953179$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTPL_ID,        MSG_ID,        UETR,        NPSSTRRD_REFNO,        PROCESS_NAME,        PROCESSING_SYSTEM,        RESPONSE_CODE,        PROCESS_REF_NO,        RESPONSE_DATA,        CREATED_DATE,        CREATEDDATEMILISEC,        PROCESS_STATUS,        STATUS,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        REVERSAL_DESC,        T24_RETURN_DESC,        CBUAE_RETURN_DESC,        TENANT_ID,        DEPARTMENT_CODE,        DT_CODE,        DTT_CODE   FROM (SELECT A.NPSSTPL_ID,                A.MSG_ID,                A.UETR,                A.NPSSTRRD_REFNO,                A.PROCESS_NAME,                A.PROCESSING_SYSTEM,                A.RESPONSE_CODE,                A.PROCESS_REF_NO,                A.RESPONSE_DATA,                TO_CHAR(A.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS CREATEDDATEMILISEC,                A.CREATED_DATE,                A.PROCESS_STATUS,                A.STATUS,                A.DT_CODE,                A.DTT_CODE,                A.TENANT_ID,                A.REQUEST_DATA_JSON,                A.RESPONSE_DATA_JSON,                A.T24_RETURN_CODE,                NT.DEPARTMENT_CODE,                A.ADDITIONAL_INFO,                T24RC.RETURN_DESCRIPTION AS T24_RETURN_DESC,                CONCAT(A.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                A.CBUAE_RETURN_CODE,                CBUAERC.RETURN_DESCRIPTION AS CBUAE_RETURN_DESC,                CONCAT(A.CBUAE_RETURN_CODE, $SQ$-$SQ$, CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                A.REVERSAL_CODE,                CCD.CD_DESCRIPTION AS REVERSAL_DESC,                CONCAT(A.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION           FROM NPSS_TRN_PROCESS_LOG A           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                                   A.REVERSAL_CODE                                                               AND CCD.CD_CATEGORY =                                                                   $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$           LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                                A.T24_RETURN_CODE                                                            AND T24RC.PROCESSING_SYSTEM =                                                                $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$           LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                                  A.CBUAE_RETURN_CODE                                                              AND CBUAERC.PROCESSING_SYSTEM =                                                                  $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$          INNER JOIN NPSS_TRANSACTIONS NT ON NT.UETR = A.UETR          ORDER BY A.NPSSTPL_ID) V $WHERE$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665905039255$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_8$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669787086577_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669791926368~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669787086577_0$DQ$,$DQ$DS_1669791926368$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_5$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669787086577_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669791122012~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669787086577_0$DQ$,$DQ$DS_1669791122012$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ select GROUP_NAME,        INTRBK_STTLM_CUR,        SUM(INTRBK_STTLM_AMNT) as TOTAL_AMOUNT,        COUNT(NPSST_ID) as TOTAL_TRAN_COUNT   from (select NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as DATEMI,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           from NPSS_TRANSACTIONS NT          inner join (select T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       from (select A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    row_number() over(partition by A.UETR order by A.NPSSTPL_ID desc) as ROW_NUM                               from NPSS_TRN_PROCESS_LOG A) T                      inner join <tran_db>.CORE_NC_STATUS_GROUP G on G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       and G.PROCESS_QUEUE_STATUS =                                                           T.STATUS  AND G.STATUS = $SQ$APPROVED$SQ$                      where T.ROW_NUM = 1) NTPL on NT.UETR = NTPL.UETR           left join (select B.NPSSTRRD_ID,                            B.MSG_ID as RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE as RR_DT_CODE,                            B.DTT_CODE as RR_DTT_CODE,                            B.PROCESS_NAME as RR_PROCESS_NAME,                            B.MESSAGE_DESC as RR_MESSAGE_DESC,                            row_number() over(partition by B.UETR order by B.NPSSTRRD_ID desc) as ROW_NUM                       from NPSS_TRN_REQ_RESP_DTLS B) RR on RR.UETR = NT.UETR                                                        and RR.ROW_NUM = 1) V $WHERE  group by GROUP_NAME, INTRBK_STTLM_CUR$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_18$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669787086577_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669790984220~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669787086577_0$DQ$,$DQ$DS_1669790984220$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT GROUP_NAME, GN_SORT_ORDER, COUNT(GROUP_NAME) AS GROUP_COUNT   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                GN_SORT_ORDER           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            CD.SORT_ORDER AS GN_SORT_ORDER                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      INNER JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CD ON CD.CD_CODE =                                                                 G.GROUP_NAME AND CD.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1                        AND CD.CD_CATEGORY = $SQ$STATUS_GROUP$SQ$) NTPL ON NT.UETR =                                                                     NTPL.UETR           LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  GROUP BY GN_SORT_ORDER, GROUP_NAME  ORDER BY GN_SORT_ORDER$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_2$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669787086577_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665903906193~DS_1669789000776~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669787086577_0$DQ$,$DQ$DS_1669789000776$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSSTRRD_ID,        MSG_ID,        UETR,        PARENT_NPSSTRRD_REFNO,        NPSSTRRD_REFNO,        PROCESS_CODE,        PROCESS_DETAIL,        EXHF_ID,        PROCESS_NAME,        MESSAGE_DESC,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        STATUS,        PROCESS_STATUS,        MESSAGE_DATA,        CREATEDDATEMILISEC,        DT_CODE,        DTT_CODE   FROM (SELECT NPSSTRRD.NPSSTRRD_ID,                NPSSTRRD.MSG_ID,                NPSSTRRD.UETR,                NPSSTRRD.PARENT_NPSSTRRD_REFNO,                NPSSTRRD.NPSSTRRD_REFNO,                NPSSTRRD.MESSAGE_DATA,                NPSSTRRD.PROCESS_CODE,                NPSSTRRD.PROCESS_DETAIL,                NPSSTRRD.EXHF_ID,                NPSSTRRD.PROCESS_NAME,                NPSSTRRD.MESSAGE_DESC,                NPSSTRRD.CHANNEL_ID,                NPSSTRRD.CHANNEL_REFNO,                NPSSTRRD.CHANNEL_USERID,                NPSSTRRD.CHANNEL_PRODUCT,                NPSSTRRD.CHANNEL_SUB_PRODUCT,                NPSSTRRD.CHANNEL_TRAN_CODE,                NPSSTRRD.CREATED_BY,                NPSSTRRD.CREATED_BY_NAME,                NPSSTRRD.CREATED_DATE,                NPSSTRRD.DT_CODE,                NPSSTRRD.DT_DESCRIPTION,                NPSSTRRD.DTT_CODE,                NPSSTRRD.DTT_DESCRIPTION,                NPSSTRRD.MODIFIED_BY,                NPSSTRRD.MODIFIED_BY_NAME,                NPSSTRRD.MODIFIED_DATE,                NPSSTRRD.STATUS,                NPSSTRRD.PROCESS_STATUS,                NPSSTRRD.SYSTEM_ID,                NPSSTRRD.SYSTEM_NAME,                NPSSTRRD.TENANT_ID,                NPSSTRRD.APP_ID,                NPSSTRRD.VERSION_NO,                TO_CHAR(NPSSTRRD.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as CREATEDDATEMILISEC           FROM NPSS_TRN_REQ_RESP_DTLS NPSSTRRD) RR $WHERE$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665903906193$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_15$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669787295394_0",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" DELETE FROM QRY_INFO WHERE WFTPA_ID=? AND APP_ID=?\", \"params\" : [\"WFT_NPSS_P_1304_1669787295394_0\", \"215\"] }",
  "qry_type": "D"
},{
  "key": "215~WFT_NPSS_P_1304_1669787295394_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669787910785~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669787295394_0$DQ$,$DQ$DS_1669787910785$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_5$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669787295394_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669787789426~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669787295394_0$DQ$,$DQ$DS_1669787789426$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT GROUP_NAME, GN_SORT_ORDER, COUNT(GROUP_NAME) AS GROUP_COUNT   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                GN_SORT_ORDER           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            CD.SORT_ORDER AS GN_SORT_ORDER                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      INNER JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CD ON CD.CD_CODE =                                                                 G.GROUP_NAME AND CD.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1                        AND CD.CD_CATEGORY = $SQ$STATUS_GROUP$SQ$) NTPL ON NT.UETR =                                                                     NTPL.UETR           LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  GROUP BY GN_SORT_ORDER, GROUP_NAME  ORDER BY GN_SORT_ORDER$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_2$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669787295394_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669787861864~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669787295394_0$DQ$,$DQ$DS_1669787861864$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_4$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669787295394_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669787750081~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669787295394_0$DQ$,$DQ$DS_1669787750081$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT PROCESSING_SYSTEM, COUNT(PROCESSING_SYSTEM) AS PS_COUNT   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_NAME,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                      WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  GROUP BY PROCESSING_SYSTEM$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_9$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669787295394_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669787960833~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669787295394_0$DQ$,$DQ$DS_1669787960833$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSST_ID,        UETR,        VALUE_DATE,        ACCP_DATE_TIME,        CREATED_DATE,        DATEMI,        EXHF_ID,        CDTR_IBAN,        TENANT_ID,        TRAN_REF_ID,        DEPARTMENT_CODE,        PAYMENT_ENDTOEND_ID,        CLRSYSREF,        CDTR_ACCT_NO,        DBTR_ACCT_NO,        INTRBK_STTLM_CUR,        INTRBK_STTLM_AMNT,        STATUS,        PROCESSING_SYSTEM,        PROCESS_STATUS,        GROUP_NAME,        PROCESS_TYPE,        PAYMENT_MODE,        RULE_GROUP,        NPSSTPL_ID,        DT_CODE,        DTT_CODE,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        MSG_ID,        PROCESS_NAME,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        ADDITIONAL_INFO,        V_CODE,        AMOUNT_CREDITED,        AMT_CR_LOC_CUR,        CHARGE_AMOUNT,        REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTRRD_ID,        RR_DT_CODE,        RR_DTT_CODE,        MESSAGE_DATA,        PROCESS_CODE,        PROCESS_DETAIL,        RR_PROCESS_NAME,        RR_MESSAGE_DESC,        DBTR_ACCT_NAME,        DBTR_PHONE_NO,        DBTR_EMAIL_ID,        DBTR_DOCUMENT_ID,        DBTR_IBAN,        DBTR_CUST_TYPE,        DBTR_PRVT_ID,        DBTR_OTHER_ISSUER,        CDTR_ACCT_NAME,        CDTR_PHONE_NO,        CDTR_EMAIL_ID,        CDTR_DOCUMENT_ID,        DR_SORT_CODE,        CR_SORT_CODE,        CATEGORY_PURPOSE,        CATEGORY_PURPOSE_PRTY,        CR_ACCT_IDENTIFICATION,        BASE_CURRENCY,        BASE_AMOUNT,        HDR_TOTAL_RECORDS,        HDR_TOTAL_AMOUNT,        HDR_CLEARING_SYSTEM,        CHARGE_BEARER,        REMITTANCE_INFO,        ACCOUNT_CURRENCY,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        ISSUER_TYPE_CODE,        PROCESS_REF_NO,        RESPONSE_CODE,        CBS_REF_NO,        CBS_POSTING_FLAG   FROM (SELECT NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS DATEMI,                NT.DEPARTMENT_CODE,                NT.TENANT_ID,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                NTPL.T24_RETURN_CODE,                NTPL.CBUAE_RETURN_CODE,                NTPL.REVERSAL_CODE,                NTPL.ADDITIONAL_INFO,                NTPL.V_CODE,                NTPL.AMOUNT_CREDITED,                NTPL.AMT_CR_LOC_CUR,                NTPL.CHARGE_AMOUNT,                NTPL.PROCESS_REF_NO,                NTPL.RESPONSE_CODE,                CONCAT(NTPL.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION,                CONCAT(NTPL.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                CONCAT(NTPL.CBUAE_RETURN_CODE,                       $SQ$-$SQ$,                       CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE,                NT.CBS_REF_NO,                NT.CBS_POSTING_FLAG           FROM NPSS_TRANSACTIONS NT          INNER JOIN (SELECT T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME,                            T.T24_RETURN_CODE,                            T.CBUAE_RETURN_CODE,                            T.REVERSAL_CODE,                            T.ADDITIONAL_INFO,                            T.V_CODE,                            T.AMOUNT_CREDITED,                            T.AMT_CR_LOC_CUR,                            T.CHARGE_AMOUNT,                            T.PROCESS_REF_NO,                            T.RESPONSE_CODE                       FROM (SELECT A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    A.T24_RETURN_CODE,                                    A.CBUAE_RETURN_CODE,                                    A.REVERSAL_CODE,                                    A.ADDITIONAL_INFO,                                    A.V_CODE,                                    A.AMOUNT_CREDITED,                                    A.AMT_CR_LOC_CUR,                                    A.CHARGE_AMOUNT,                                    A.PROCESS_REF_NO,                                    A.RESPONSE_CODE,                                    ROW_NUMBER() OVER(PARTITION BY A.UETR ORDER BY A.NPSSTPL_ID DESC) AS ROW_NUM                               FROM NPSS_TRN_PROCESS_LOG A) T                      INNER JOIN <tran_db>.CORE_NC_STATUS_GROUP G ON G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       AND G.PROCESS_QUEUE_STATUS =                                                           T.STATUS AND G.STATUS = $SQ$APPROVED$SQ$                       WHERE T.ROW_NUM = 1) NTPL ON NT.UETR = NTPL.UETR           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                      NTPL.REVERSAL_CODE                                                  AND CCD.CD_CATEGORY =                                                      $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                   NTPL.T24_RETURN_CODE                                               AND T24RC.PROCESSING_SYSTEM =                                                   $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                     NTPL.CBUAE_RETURN_CODE                                                 AND CBUAERC.PROCESSING_SYSTEM =                                                     $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$            LEFT JOIN (SELECT B.NPSSTRRD_ID,                            B.MSG_ID AS RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE AS RR_DT_CODE,                            B.DTT_CODE AS RR_DTT_CODE,                            B.PROCESS_NAME AS RR_PROCESS_NAME,                            B.MESSAGE_DESC AS RR_MESSAGE_DESC,                            ROW_NUMBER() OVER(PARTITION BY B.UETR ORDER BY B.NPSSTRRD_ID DESC) AS ROW_NUM                       FROM NPSS_TRN_REQ_RESP_DTLS B) RR ON RR.UETR = NT.UETR                                                        AND RR.ROW_NUM = 1) V $WHERE  ORDER BY NPSST_ID DESC$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_19$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669787295394_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1669787830873~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669787295394_0$DQ$,$DQ$DS_1669787830873$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ select GROUP_NAME,        INTRBK_STTLM_CUR,        SUM(INTRBK_STTLM_AMNT) as TOTAL_AMOUNT,        COUNT(NPSST_ID) as TOTAL_TRAN_COUNT   from (select NT.NPSST_ID,                NT.UETR,                NT.VALUE_DATE,                NT.ACCP_DATE_TIME,                NT.CREATED_DATE,                TO_CHAR(NT.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as DATEMI,                NT.TENANT_ID,                NT.DEPARTMENT_CODE,                NT.EXHF_ID,                NT.CDTR_IBAN,                NT.TRAN_REF_ID,                NT.PAYMENT_ENDTOEND_ID,                NT.CLRSYSREF,                NT.CDTR_ACCT_NO,                NT.DBTR_ACCT_NO,                NT.INTRBK_STTLM_CUR,                NT.INTRBK_STTLM_AMNT,                NTPL.STATUS,                NTPL.PROCESSING_SYSTEM,                NTPL.PROCESS_STATUS,                NTPL.GROUP_NAME,                NTPL.PROCESS_TYPE,                NTPL.PAYMENT_MODE,                NTPL.RULE_GROUP,                NTPL.NPSSTPL_ID,                NTPL.DT_CODE,                NTPL.DTT_CODE,                NTPL.REQUEST_DATA_JSON,                NTPL.RESPONSE_DATA_JSON,                NTPL.MSG_ID,                NTPL.PROCESS_NAME,                RR.NPSSTRRD_ID,                RR.RR_MSG_ID,                RR.PARENT_NPSSTRRD_REFNO,                RR.MESSAGE_DATA,                RR.PROCESS_CODE,                RR.PROCESS_DETAIL,                RR.NPSSTRRD_REFNO,                RR.RR_DT_CODE,                RR.RR_DTT_CODE,                RR.RR_PROCESS_NAME,                RR.RR_MESSAGE_DESC,                NT.DBTR_ACCT_NAME,                NT.DBTR_PHONE_NO,                NT.DBTR_EMAIL_ID,                NT.DBTR_DOCUMENT_ID,                NT.DBTR_IBAN,                NT.DBTR_CUST_TYPE,                NT.DBTR_PRVT_ID,                NT.DBTR_OTHER_ISSUER,                NT.CDTR_ACCT_NAME,                NT.CDTR_PHONE_NO,                NT.CDTR_EMAIL_ID,                NT.CDTR_DOCUMENT_ID,                NT.DR_SORT_CODE,                NT.CR_SORT_CODE,                NT.CATEGORY_PURPOSE,                NT.CATEGORY_PURPOSE_PRTY,                NT.CR_ACCT_IDENTIFICATION,                NT.BASE_CURRENCY,                NT.BASE_AMOUNT,                NT.HDR_TOTAL_RECORDS,                NT.HDR_TOTAL_AMOUNT,                NT.HDR_CLEARING_SYSTEM,                NT.CHARGE_BEARER,                NT.REMITTANCE_INFO,                NT.ACCOUNT_CURRENCY,                NT.CHANNEL_ID,                NT.CHANNEL_REFNO,                NT.CHANNEL_USERID,                NT.CHANNEL_PRODUCT,                NT.CHANNEL_SUB_PRODUCT,                NT.CHANNEL_TRAN_CODE,                NT.ISSUER_TYPE_CODE           from NPSS_TRANSACTIONS NT          inner join (select T.NPSSTPL_ID,                            T.UETR,                            T.STATUS,                            T.PROCESSING_SYSTEM,                            T.PROCESS_STATUS,                            G.GROUP_NAME,                            G.PROCESS_TYPE,                            G.PAYMENT_MODE,                            G.RULE_GROUP,                            T.DT_CODE,                            T.DTT_CODE,                            T.REQUEST_DATA_JSON,                            T.RESPONSE_DATA_JSON,                            T.MSG_ID,                            T.PROCESS_NAME                       from (select A.NPSSTPL_ID,                                    A.UETR,                                    A.STATUS,                                    A.PROCESSING_SYSTEM,                                    A.PROCESS_STATUS,                                    A.DT_CODE,                                    A.DTT_CODE,                                    A.REQUEST_DATA_JSON,                                    A.RESPONSE_DATA_JSON,                                    A.MSG_ID,                                    A.PROCESS_NAME,                                    row_number() over(partition by A.UETR order by A.NPSSTPL_ID desc) as ROW_NUM                               from NPSS_TRN_PROCESS_LOG A) T                      inner join <tran_db>.CORE_NC_STATUS_GROUP G on G.QUEUE_CODE =                                                           T.PROCESS_STATUS                                                       and G.PROCESS_QUEUE_STATUS =                                                           T.STATUS  AND G.STATUS = $SQ$APPROVED$SQ$                      where T.ROW_NUM = 1) NTPL on NT.UETR = NTPL.UETR           left join (select B.NPSSTRRD_ID,                            B.MSG_ID as RR_MSG_ID,                            B.PARENT_NPSSTRRD_REFNO,                            B.MESSAGE_DATA,                            B.PROCESS_CODE,                            B.PROCESS_DETAIL,                            B.NPSSTRRD_REFNO,                            B.UETR,                            B.DT_CODE as RR_DT_CODE,                            B.DTT_CODE as RR_DTT_CODE,                            B.PROCESS_NAME as RR_PROCESS_NAME,                            B.MESSAGE_DESC as RR_MESSAGE_DESC,                            row_number() over(partition by B.UETR order by B.NPSSTRRD_ID desc) as ROW_NUM                       from NPSS_TRN_REQ_RESP_DTLS B) RR on RR.UETR = NT.UETR                                                        and RR.ROW_NUM = 1) V $WHERE  group by GROUP_NAME, INTRBK_STTLM_CUR$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_18$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669787295394_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665905039255~DS_1669787655635~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669787295394_0$DQ$,$DQ$DS_1669787655635$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT REVERSAL_DESCRIPTION,        T24_RETURN_DESCRIPTION,        CBUAE_RETURN_DESCRIPTION,        NPSSTPL_ID,        MSG_ID,        UETR,        NPSSTRRD_REFNO,        PROCESS_NAME,        PROCESSING_SYSTEM,        RESPONSE_CODE,        PROCESS_REF_NO,        RESPONSE_DATA,        CREATED_DATE,        CREATEDDATEMILISEC,        PROCESS_STATUS,        STATUS,        REQUEST_DATA_JSON,        RESPONSE_DATA_JSON,        T24_RETURN_CODE,        CBUAE_RETURN_CODE,        REVERSAL_CODE,        REVERSAL_DESC,        T24_RETURN_DESC,        CBUAE_RETURN_DESC,        TENANT_ID,        DEPARTMENT_CODE,        DT_CODE,        DTT_CODE   FROM (SELECT A.NPSSTPL_ID,                A.MSG_ID,                A.UETR,                A.NPSSTRRD_REFNO,                A.PROCESS_NAME,                A.PROCESSING_SYSTEM,                A.RESPONSE_CODE,                A.PROCESS_REF_NO,                A.RESPONSE_DATA,                TO_CHAR(A.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) AS CREATEDDATEMILISEC,                A.CREATED_DATE,                A.PROCESS_STATUS,                A.STATUS,                A.DT_CODE,                A.DTT_CODE,                A.TENANT_ID,                A.REQUEST_DATA_JSON,                A.RESPONSE_DATA_JSON,                A.T24_RETURN_CODE,                NT.DEPARTMENT_CODE,                A.ADDITIONAL_INFO,                T24RC.RETURN_DESCRIPTION AS T24_RETURN_DESC,                CONCAT(A.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) AS T24_RETURN_DESCRIPTION,                A.CBUAE_RETURN_CODE,                CBUAERC.RETURN_DESCRIPTION AS CBUAE_RETURN_DESC,                CONCAT(A.CBUAE_RETURN_CODE, $SQ$-$SQ$, CBUAERC.RETURN_DESCRIPTION) AS CBUAE_RETURN_DESCRIPTION,                A.REVERSAL_CODE,                CCD.CD_DESCRIPTION AS REVERSAL_DESC,                CONCAT(A.REVERSAL_CODE, $SQ$-$SQ$, CCD.CD_DESCRIPTION) AS REVERSAL_DESCRIPTION           FROM NPSS_TRN_PROCESS_LOG A           LEFT JOIN <tran_db>.CORE_NC_CODE_DESCRIPTIONS CCD ON CCD.CD_CODE =                                                                   A.REVERSAL_CODE                                                               AND CCD.CD_CATEGORY =                                                                   $SQ$REVERSAL_REASON_IDENTIFIER_CODE$SQ$ AND CCD.STATUS = $SQ$APPROVED$SQ$           LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES T24RC ON T24RC.RETURN_CODE =                                                                A.T24_RETURN_CODE                                                            AND T24RC.PROCESSING_SYSTEM =                                                                $SQ$T24$SQ$ AND T24RC.STATUS = $SQ$APPROVED$SQ$           LEFT JOIN <tran_db>.CORE_NC_RETURN_CODES CBUAERC ON CBUAERC.RETURN_CODE =                                                                  A.CBUAE_RETURN_CODE                                                              AND CBUAERC.PROCESSING_SYSTEM =                                                                  $SQ$CBUAE$SQ$ AND CBUAERC.STATUS = $SQ$APPROVED$SQ$          INNER JOIN NPSS_TRANSACTIONS NT ON NT.UETR = A.UETR          ORDER BY A.NPSSTPL_ID) V $WHERE$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665905039255$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_8$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1669787295394_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665903906193~DS_1669787723298~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1669787295394_0$DQ$,$DQ$DS_1669787723298$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ SELECT NPSSTRRD_ID,        MSG_ID,        UETR,        PARENT_NPSSTRRD_REFNO,        NPSSTRRD_REFNO,        PROCESS_CODE,        PROCESS_DETAIL,        EXHF_ID,        PROCESS_NAME,        MESSAGE_DESC,        CHANNEL_ID,        CHANNEL_REFNO,        CHANNEL_USERID,        CHANNEL_PRODUCT,        CHANNEL_SUB_PRODUCT,        CHANNEL_TRAN_CODE,        STATUS,        PROCESS_STATUS,        MESSAGE_DATA,        CREATEDDATEMILISEC,        DT_CODE,        DTT_CODE   FROM (SELECT NPSSTRRD.NPSSTRRD_ID,                NPSSTRRD.MSG_ID,                NPSSTRRD.UETR,                NPSSTRRD.PARENT_NPSSTRRD_REFNO,                NPSSTRRD.NPSSTRRD_REFNO,                NPSSTRRD.MESSAGE_DATA,                NPSSTRRD.PROCESS_CODE,                NPSSTRRD.PROCESS_DETAIL,                NPSSTRRD.EXHF_ID,                NPSSTRRD.PROCESS_NAME,                NPSSTRRD.MESSAGE_DESC,                NPSSTRRD.CHANNEL_ID,                NPSSTRRD.CHANNEL_REFNO,                NPSSTRRD.CHANNEL_USERID,                NPSSTRRD.CHANNEL_PRODUCT,                NPSSTRRD.CHANNEL_SUB_PRODUCT,                NPSSTRRD.CHANNEL_TRAN_CODE,                NPSSTRRD.CREATED_BY,                NPSSTRRD.CREATED_BY_NAME,                NPSSTRRD.CREATED_DATE,                NPSSTRRD.DT_CODE,                NPSSTRRD.DT_DESCRIPTION,                NPSSTRRD.DTT_CODE,                NPSSTRRD.DTT_DESCRIPTION,                NPSSTRRD.MODIFIED_BY,                NPSSTRRD.MODIFIED_BY_NAME,                NPSSTRRD.MODIFIED_DATE,                NPSSTRRD.STATUS,                NPSSTRRD.PROCESS_STATUS,                NPSSTRRD.SYSTEM_ID,                NPSSTRRD.SYSTEM_NAME,                NPSSTRRD.TENANT_ID,                NPSSTRRD.APP_ID,                NPSSTRRD.VERSION_NO,                TO_CHAR(NPSSTRRD.CREATED_DATE, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as CREATEDDATEMILISEC           FROM NPSS_TRN_REQ_RESP_DTLS NPSSTRRD) RR $WHERE$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665903906193$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_15$DQ$] }",
  "qry_type": "I"
}]