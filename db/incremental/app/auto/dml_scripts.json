[{
  "key": "215~WFT_NPSS_P_1304_1708336628425_0",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" DELETE FROM QRY_INFO WHERE WFTPA_ID=? AND APP_ID=?\", \"params\" : [\"WFT_NPSS_P_1304_1708336628425_0\", \"215\"] }",
  "qry_type": "D"
},{
  "key": "215~WFT_NPSS_P_1304_1708336628425_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1708336721553~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1708336628425_0$DQ$,$DQ$DS_1708336721553$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ select  distinct UETR,  PROCESS_STATUS,  STATUS,  CREATED_DATE,  VALUE_DATE,  DEPARTMENT_CODE,  DBTR_IBAN,  DBTR_ACCT_NAME,  CDTR_IBAN,  CDTR_ACCT_NAME,  CR_SORT_CODE,  CHANNEL_ID,  BENEFICIARY_BANK,  API_SUCCESS_FAILURE,  INTRBK_STTLM_AMNT,  PURPOSE_CODES,  CHANNEL_REFNO,  FN_CARD_DECRYPT_AND_MASK_RPT(CR_ACCT_IDENTIFICATION) as CR_ACCT_IDENTIFICATION,  FN_CARD_DECRYPT_AND_MASK_RPT(DBTR_ACCT_NO) as DBTR_ACCT_NO,  CB_ERRORS,  CORE_BANK_ERRORS,  MAKER,  CHECKER,  PROCESS_GROUP,  TRANSACTION_ID,  CATEGORY_PURPOSE,  FT_CI_REFERENCE_NUMBER,  PROCESS_TYPE,  CLRSYSREF,  PAYMENT_ENDTOEND_ID,  Batch_Payment_Flag,  OUTWARD_FILE_NAME from  (  select   NTPL.UETR,   NT.PROCESS_STATUS,   NT.STATUS,   NT.CREATED_DATE,   NT.VALUE_DATE,   NT.DEPARTMENT_CODE,   NT.OUTWARD_FILE_NAME,   case    when NT.process_group = $SQ$BCT$SQ$ then $SQ$Y$SQ$    else $SQ$N$SQ$   end as Batch_Payment_Flag,   case    when NT.PROCESS_GROUP = $SQ$IBAN$SQ$ then $SQ$WEBI$SQ$    when NT.PROCESS_GROUP = $SQ$P2P$SQ$ then $SQ$MP2P$SQ$    when NT.PROCESS_GROUP = $SQ$P2B$SQ$ then $SQ$MP2B$SQ$    when NT.PROCESS_GROUP = $SQ$MANUAL$SQ$ then $SQ$WEBI$SQ$   end as PURPOSE_CODES,   NT.PAYMENT_ENDTOEND_ID,   NT.DBTR_IBAN,   NT.DBTR_ACCT_NAME,   NT.CDTR_IBAN,   NT.CDTR_ACCT_NAME,   NT.CR_SORT_CODE,   NT.CHANNEL_ID,   NT.CHANNEL_REFNO,   NT.PROCESS_TYPE,   NT.TENANT_ID,   NT.DT_CODE,   NT.DTT_CODE,   NT.MAKER,   NT.CHECKER,   NT.CR_ACCT_IDENTIFICATION,   NT.DBTR_ACCT_NO,   NT.PROCESS_GROUP,   NT.CATEGORY_PURPOSE,   NT.INTRBK_STTLM_AMNT,   A13.CBUAERETURNCODE as CB_ERRORS,   A11.T24RETURNCODE as CORE_BANK_ERRORS,   A15.PROCESS_REF_NO as CLRSYSREF,   CMB.BANK_NAME as BENEFICIARY_BANK,   CSE.S_DESCRIPTION,   NTPL.PROCESS_NAME,   case    when NT.PROCESS_GROUP in ($SQ$P2B$SQ$, $SQ$P2P$SQ$) then NT.TRAN_REF_ID    when NT.PROCESS_GROUP in ($SQ$IBAN$SQ$) then NT.MIDDLEWARE_REF_NO   end as TRANSACTION_ID,   case    when NT.PROCESS_GROUP in ($SQ$IBAN$SQ$) then NT.TRAN_REF_ID    when NT.PROCESS_GROUP in ($SQ$P2B$SQ$, $SQ$P2P$SQ$) then NT.PAYMENT_ENDTOEND_ID   end as FT_CI_REFERENCE_NUMBER,   case    when NT.PROCESS_STATUS not in ($SQ$RCTRejected$SQ$) then $SQ$Success$SQ$    when NT.PROCESS_STATUS = $SQ$RCTRejected$SQ$ then $SQ$Failure$SQ$   end as API_SUCCESS_FAILURE  from   <TRAN_DB>.NPSS_TRANSACTIONS NT  inner join <TRAN_DB>.NPSS_TRN_PROCESS_LOG NTPL on   NT.UETR = NTPL.UETR  left join (   select    NPSSTPL_ID,    UETR,    CBUAERETURNCODE   from    (    select     A3.NPSSTPL_ID,     A3.UETR,     A3.STATUS,     A3.CBUAE_RETURN_CODE,     CONCAT(A3.CBUAE_RETURN_CODE,     $SQ$-$SQ$,     CNEC1.ERROR_DESCRIPTION) as CBUAERETURNCODE    from     (     select      NPSSTPL_ID,      STATUS,      UETR,      CBUAE_RETURN_CODE,      ROW_NUM     from      (      select       NPSSTPL_ID,       UETR,       STATUS,       CBUAE_RETURN_CODE,       row_number() over (partition by UETR      order by       NPSSTPL_ID desc) as ROW_NUM      from       <TRAN_DB>.NPSS_TRN_PROCESS_LOG A01) F     where      ROW_NUM = 1 ) A3    left join CORE_NC_ERROR_CODES CNEC1 on     CNEC1.ERROR_CODE = A3.CBUAE_RETURN_CODE     and CNEC1.PROCESSING_SYSTEM = $SQ$CBUAE$SQ$    where     A3.STATUS in ($SQ$OP_AC_REV_POSTING_FAILURE$SQ$, $SQ$OP_P2P_REV_POSTING_FAILURE$SQ$, $SQ$OP_P2B_REV_POSTING_FAILURE$SQ$, $SQ$OP_AC_STATUS_REJECTED$SQ$, $SQ$OP_P2P_STATUS_REJECTED$SQ$, $SQ$OP_P2B_STATUS_REJECTED$SQ$, $SQ$OP_AC_RET_POSTING_FAILURE$SQ$)    order by     NPSSTPL_ID desc) A13) A13 on   A13.UETR = NT.UETR  left join (   select    NPSSTPL_ID,    UETR,    T24RETURNCODE   from    (    select     A2.NPSSTPL_ID,     A2.UETR,     A2.T24_RETURN_CODE,     CONCAT(A2.T24_RETURN_CODE,     $SQ$-$SQ$,     CNEC.ERROR_DESCRIPTION) as T24RETURNCODE    from     (     select      NPSSTPL_ID,      UETR,      T24_RETURN_CODE,      ROW_NUM     from      (      select       NPSSTPL_ID,       UETR,       T24_RETURN_CODE,       row_number() over (partition by UETR      order by       NPSSTPL_ID desc) as ROW_NUM      from       <TRAN_DB>.NPSS_TRN_PROCESS_LOG A1) F     where      ROW_NUM = 1 ) A2    left join CORE_NC_ERROR_CODES CNEC on     CNEC.ERROR_CODE = A2.T24_RETURN_CODE    where     A2.T24_RETURN_CODE is not null    order by     NPSSTPL_ID desc) A12) A11 on   A11.UETR = NT.UETR  left join CORE_MEMBER_BANKS CMB on   CMB.BIC_CODE = NT.CR_SORT_CODE   and CMB.NEED_SYNC = $SQ$Y$SQ$  left join (   select    A15.NPSSTPL_ID,    A15.UETR,    A15.PROCESS_REF_NO   from    (    select     A5.NPSSTPL_ID,     A5.UETR,     A5.PROCESS_REF_NO    from     (     select      NPSSTPL_ID,      UETR,      PROCESS_REF_NO,      ROW_NUM     from      (      select       NPSSTPL_ID,       UETR,       PROCESS_REF_NO,       row_number() over (partition by UETR      order by       NPSSTPL_ID desc) as ROW_NUM      from       <TRAN_DB>.NPSS_TRN_PROCESS_LOG A05      where       A05.PROCESS_NAME = $SQ$Receive Pacs002$SQ$       and A05.PROCESS_TYPE = $SQ$OP$SQ$ ) F     where      F.ROW_NUM = 1 ) A5    order by     A5.NPSSTPL_ID desc) A15) A15 on   A15.UETR = NT.UETR  inner join CORE_SYSTEM_EXTN CSE on   CSE.DEPARTMENT_CODE = NT.DEPARTMENT_CODE) V1 where  PROCESS_TYPE = $SQ$OP$SQ$ $AND$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_1$DQ$] }",
  "qry_type": "I"
}]