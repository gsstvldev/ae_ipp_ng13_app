[{
  "key": "215~WFT_NPSS_P_1304_1710147659345_0",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" DELETE FROM QRY_INFO WHERE WFTPA_ID=? AND APP_ID=?\", \"params\" : [\"WFT_NPSS_P_1304_1710147659345_0\", \"215\"] }",
  "qry_type": "D"
},{
  "key": "215~WFT_NPSS_P_1304_1710147659345_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1710218712659~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1710147659345_0$DQ$,$DQ$DS_1710218712659$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ select  distinct UETR,  process_status ,  status ,  created_date ,  value_date ,  department_code ,  intrbk_sttlm_amnt ,  ext_purpose_code,  payment_endtoend_id ,  dbtr_iban ,  FN_CARD_DECRYPT_AND_MASK_RPT(CR_ACCT_IDENTIFICATION) as CR_ACCT_IDENTIFICATION,  FN_CARD_DECRYPT_AND_MASK_RPT(DBTR_ACCT_NO) as DBTR_ACCT_NO,  dbtr_acct_name ,  cdtr_iban ,  clrsysref,  hdr_msg_id,  category_purpose_prty,  fx_resv_text1,  cdtr_acct_name ,  dr_sort_code ,  SOURCE_CHANNEL,  SENDER_BANK,  CB_ERRORS,  Core_Bank_Errors,  tran_ref_id,  SENDER_REFERENCE_NUMBER,  maker,  PROCESS_GROUP,  checker,  MEM_PAYMENT_METHOD,  INWARD_FILE_NAME from  (  select   NTPL.UETR,   NT.process_status ,   NT.status ,   NT.created_date ,   NT.value_date ,   NT.hdr_msg_id,   NT.category_purpose_prty,   NT.fx_resv_text1,   nt.department_code,   NT.intrbk_sttlm_amnt,   NT.ext_purpose_code,   NT.payment_endtoend_id ,   NT.dbtr_iban,   NT.dbtr_acct_name,   NT.cdtr_iban,   NT.cdtr_acct_name,   NT.dr_sort_code ,   NT.channel_id as SOURCE_CHANNEL ,   NT.tran_ref_id as SENDER_REFERENCE_NUMBER,   NT.tran_ref_id,   NT.channel_refno,   a15.PROCESS_REF_NO as clrsysref,   NT.process_type ,   NT.tenant_id ,   NT.PROCESS_GROUP,   NT.maker,   NT.checker,   NT.cr_acct_identification,   NT.dbtr_acct_no,   NTPL.process_name ,   NT.INWARD_FILE_NAME,   plcduae.CBUAERETURNCODE as CB_ERRORS,   plc.T24RETURNCODE as Core_Bank_Errors,   cmb.bank_name as SENDER_BANK,   cse.s_description,   CASE             when NT.process_group =$SQ$BCT$SQ$ THEN $SQ$Y$SQ$    else $SQ$N$SQ$         END AS MEM_PAYMENT_METHOD,   case    when ntpl.process_name = $SQ$Inward Credit Posting$SQ$    and ntpl.status = $SQ$IP_RCT_POSTING_SUCCESS$SQ$    and ntpl.process_type = $SQ$IP$SQ$ then ntpl.PROCESS_REF_NO    else $SQ$Others$SQ$   end as FT_CI_REFERENCE_NUMBER  from   <TRAN_DB>.npss_transactions nt  inner join <TRAN_DB>.NPSS_TRN_PROCESS_LOG NTPL on   NT.UETR = NTPL.uetr  left join (   select    plr.npsstpl_id,    plr.uetr,    plr.CBUAE_RETURN_CODE,    plr.CBUAERETURNCODE,    plr.row_num   from    (    select     a.npsstpl_id,     a.uetr,     a.CBUAE_RETURN_CODE,     CONCAT (a.CBUAE_RETURN_CODE,     $SQ$-$SQ$,     cnec.error_description) as CBUAERETURNCODE,     row_number() over( partition by a.uetr    order by     a.npsstpl_id desc) as row_num    from     <TRAN_DB>.npss_trn_process_log a    left join core_nc_error_codes cnec on     a.CBUAE_RETURN_CODE = cnec.error_code     and cnec.processing_system = $SQ$CBUAE$SQ$    where     A.CBUAE_RETURN_CODE is not null     and A.status in ($SQ$IP_RCT_POSTING_FAILURE$SQ$, $SQ$IP_RCT_RR_POSTING_FAILURE$SQ$)      and A.process_name in ($SQ$Inward Credit Posting$SQ$, $SQ$IR Return Reversal Posting$SQ$) ) plr   where    plr.row_num = 1) plcduae on   plcduae.uetr = nt.uetr  left join (   select    pl.npsstpl_id,    pl.uetr,    pl.T24_RETURN_CODE,    pl.T24RETURNCODE,    pl.row_num   from    (    select     a1.npsstpl_id,     a1.uetr,     a1.T24_RETURN_CODE,     CONCAT(A1.T24_RETURN_CODE, $SQ$-$SQ$, cnec.error_description ) as T24RETURNCODE,     row_number() over (partition by uetr    order by     a1.npsstpl_id desc) as row_num    from     <TRAN_DB>.npss_trn_process_log a1    left join core_nc_error_codes cnec on     cnec.error_code = A1.T24_RETURN_CODE    where     A1.T24_RETURN_CODE is not null     and A1.status in ($SQ$IP_RCT_POSTING_FAILURE$SQ$, $SQ$IP_RCT_RR_POSTING_FAILURE$SQ$)      and A1.process_name in ($SQ$Inward Credit Posting$SQ$, $SQ$IR Return Reversal Posting$SQ$)) pl   where    pl.row_num = 1) plc on   plc.uetr = nt.uetr  left join core_member_banks cmb on   cmb.bic_code = nt.dr_sort_code   and cmb.NEED_SYNC = $SQ$Y$SQ$  left join (   select    A15.npsstpl_id,    A15.uetr,    A15.PROCESS_REF_NO   from    (    select     A5.npsstpl_id,     A5.uetr,     A5.PROCESS_REF_NO    from     (     select      npsstpl_id,      uetr,      PROCESS_REF_NO,      ROW_NUM     from      (      select       npsstpl_id,       uetr,       PROCESS_REF_NO,       row_number() over (partition by uetr      order by       npsstpl_id desc) as row_num      from       <TRAN_DB>.npss_trn_process_log A05      where       A05.process_name = $SQ$Receive Pacs002$SQ$       and A05.process_type = $SQ$IP$SQ$ ) F     where      F.row_num = 1 ) A5    order by     A5.npsstpl_id desc ) A15 ) a15 on   a15.uetr = nt.uetr  inner join CORE_SYSTEM_EXTN CSE on   CSE.department_code = nt.DEPARTMENT_CODE) V where  process_type = $SQ$IP$SQ$ $AND$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_1$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1710148038193_0",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" DELETE FROM QRY_INFO WHERE WFTPA_ID=? AND APP_ID=?\", \"params\" : [\"WFT_NPSS_P_1304_1710148038193_0\", \"215\"] }",
  "qry_type": "D"
},{
  "key": "215~WFT_NPSS_P_1304_1710148038193_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1710238469706~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1710148038193_0$DQ$,$DQ$DS_1710238469706$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ select  distinct uetr,  npsst_id,  datemi,  accp_date_time,  intrbk_sttlm_cur,  exhf_id,  value_date,  cdtr_acct_no,  dbtr_acct_no,  Ordering_Bank,  Beneficiary_Bank,  product_code,  process_type,  cr_acct_identification,  tenant_id,  processing_system,  process_group,  bank_name,  department_code,  created_date,  intrbk_sttlm_amnt,  payment_endtoend_id,  dbtr_iban,  cdtr_iban,  dbtr_acct_name,  cdtr_acct_name,  SENDER_BANK,  SOURCE_CHANNEL,  PURPOSE_CODE,  IPP_REFERENCE_NUMBER,  ORIGINATOR_REF_NUMBER,  QUEUE,  status,CB_ERRORS,Core_Bank_Errors,PROCESSED_DATE,maker,checker from  (  select   a.npsst_id ,   a.value_date,   a.created_date ,   a.cdtr_acct_no,   a.cdtr_acct_name ,   a.intrbk_sttlm_amnt ,   a.intrbk_sttlm_cur,   Fn_card_decrypt_and_mask_rpt(a.dbtr_acct_no) as dbtr_acct_no,   Fn_card_decrypt_and_mask_rpt(a.cr_acct_identification) as cr_acct_identification,   a.dbtr_acct_name ,   a.dr_sort_code AS Ordering_Bank,   a.cr_sort_code  AS Beneficiary_Bank,   a.uetr,   A.department_code,   a.ext_purpose_code as PURPOSE_CODE,   a.product_code,   a.channel_id as SOURCE_CHANNEL,   a.process_type,    a.dbtr_iban ,   a.cdtr_iban ,   a.clrsysref,   a.payment_endtoend_id,   a.accp_date_time,   a.exhf_id,   a.tenant_id,   a.processing_system,    a.process_group,      a.modified_date as PROCESSED_DATE,   ntpl.process_name as MESSAGE_TYPE,   To_char(a.created_date, $SQ$YYYY-MM-DD HH:MI:SS:MS AM$SQ$) as datemi,   a.process_status as QUEUE,   a.status,    ntpl.process_ref_no as T24_FT_REF_NUMBER,   a.tran_ref_id as IPP_REFERENCE_NUMBER,   a.tran_ref_id as ORIGINATOR_REF_NUMBER,   cmb.bank_name,   cmb.bank_name as SENDER_BANK,   PLT24.T24_RETURN_CODE,   CONCAT(PLT24.T24_RETURN_CODE, $SQ$-$SQ$, T24RC.RETURN_DESCRIPTION) as Core_Bank_Errors,   plcduae.CBUAE_RETURN_CODE,   CONCAT(plcduae.CBUAE_RETURN_CODE, $SQ$-$SQ$, CBUAERC.RETURN_DESCRIPTION) as CB_Errors,   a.maker,   a.checker  from   <TRAN_DB>.npss_transactions A left join (select  plr.npsstpl_id,  plr.uetr,  plr.CBUAE_RETURN_CODE,     plr.row_num from  (  select   a.npsstpl_id,   a.uetr,   a.CBUAE_RETURN_CODE,   row_number() over( partition by a.uetr  order by   a.npsstpl_id desc) as row_num  from   <TRAN_DB>.npss_trn_process_log a where A.CBUAE_RETURN_CODE is not null) plr where  plr.row_num = 1 ) plcduae on plcduae.uetr = a.uetr left join (select  plr1.npsstpl_id,  plr1.uetr,  plr1.T24_RETURN_CODE,  plr1.row_num from  (  select   a1.npsstpl_id,   a1.uetr,   a1.T24_RETURN_CODE,   row_number() over( partition by a1.uetr  order by   a1.npsstpl_id desc) as row_num  from   <TRAN_DB>.npss_trn_process_log a1 where A1.T24_RETURN_CODE is not null) plr1 where  plr1.row_num = 1 ) plt24 on plt24.uetr = a.uetr  inner join <TRAN_DB>.NPSS_TRN_PROCESS_LOG NTPL on a.UETR = NTPL.uetr     left join CORE_NC_RETURN_CODES T24RC on   T24RC.RETURN_CODE = plt24.T24_RETURN_CODE   and T24RC.PROCESSING_SYSTEM = $SQ$T24$SQ$   and T24RC.NEED_SYNC = $SQ$Y$SQ$  left join CORE_NC_RETURN_CODES CBUAERC on   CBUAERC.RETURN_CODE = plcduae.CBUAE_RETURN_CODE   and CBUAERC.PROCESSING_SYSTEM = $SQ$CBUAE$SQ$   and CBUAERC.NEED_SYNC = $SQ$Y$SQ$  left join core_member_banks cmb on cmb.bic_code = a.cr_sort_code AND CMB.NEED_SYNC = $SQ$Y$SQ$  inner join  CORE_SYSTEM_EXTN CSE on CSE.department_code  = A.DEPARTMENT_CODE)VW where process_type = $SQ$IP$SQ$ $AND    order by datemi desc$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_1$DQ$] }",
  "qry_type": "I"
},{
  "key": "215~WFT_NPSS_P_1304_1710148147049_0",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" DELETE FROM QRY_INFO WHERE WFTPA_ID=? AND APP_ID=?\", \"params\" : [\"WFT_NPSS_P_1304_1710148147049_0\", \"215\"] }",
  "qry_type": "D"
},{
  "key": "215~WFT_NPSS_P_1304_1710148147049_0~DEFAULT~DT_1304_1665901130705~DTT_1304_1665901217208~DS_1710238660225~DEFAULT~1",
  "target": "QRY_INFO",
  "content": "{ \"query\" : \" INSERT INTO QRY_INFO (WFTPA_ID,DS_CODE,MAIN_QRY_MODE,MAIN_QRY_TYPE,MAIN_QRY_TEXT,APP_ID,SORT_ORDER,EVENT_CODE,DT_CODE,DTT_CODE,LISTING_MODE, LOCKING_MODE, LOCKING_PARAMETER,PROCESS,SETUP_JSON,SYSTEM_TYPE,UICGC_CODE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\", \"params\" : [$DQ$WFT_NPSS_P_1304_1710148147049_0$DQ$,$DQ$DS_1710238660225$DQ$,$DQ$M$DQ$,$DQ$S$DQ$,$DQ$ select  npsst_id,  accp_date_time,  intrbk_sttlm_cur,  exhf_id,  value_date,  cdtr_acct_no,  dbtr_acct_no,  dr_sort_code,  cr_sort_code,  uetr,  product_code,  process_type,  tenant_id,  tran_ref_id,  processing_system,  process_group,  bank_name,  department_code,  payment_endtoend_id,  cdtr_iban,  created_date,  dbtr_iban,  intrbk_sttlm_amnt,  cdtr_acct_name,  dbtr_acct_name,  BENEFICIARY_BANK,  npsstrrd_refno from  (  select   a.npsst_id,   a.value_date,   a.created_date,   a.cdtr_acct_no,   a.department_code,   a.cdtr_acct_name,   a.intrbk_sttlm_amnt,   a.intrbk_sttlm_cur,   a.dbtr_acct_name,   a.dr_sort_code,   a.cr_sort_code,   a.uetr,   a.ext_purpose_code,   a.product_code,   a.channel_id,   a.process_type,   a.dbtr_iban,   a.cdtr_iban,   a.clrsysref,   a.payment_endtoend_id,   a.accp_date_time,   a.dbtr_acct_no,   a.exhf_id,   a.tenant_id,   a.processing_system,   a.process_group,   a.tran_ref_id,   cmb.bank_name,   cmb.bank_name as BENEFICIARY_BANK,   pl.ADDITIONAL_INFO,   PL.npsstrrd_refno,   cse.s_description  from   npss_transactions a  inner join (   select    plr.npsstpl_id,    plr.uetr,    plr.npsstrrd_refno,    plr.ADDITIONAL_INFO,    plr.row_num   from    (    select     a.npsstpl_id,     a.uetr,     a.created_date,     a.npsstrrd_refno,     a.ADDITIONAL_INFO,     row_number() over( partition by a.uetr    order by     a.npsstpl_id desc) as row_num    from     npss_trn_process_log a ) plr    where    plr.row_num = 1) pl on   pl.uetr = a.uetr   left join core_member_banks cmb on   cmb.bic_code = a.cr_sort_code   and cmb.NEED_SYNC = $SQ$Y$SQ$  inner join CORE_SYSTEM_EXTN CSE on   CSE.department_code = A.DEPARTMENT_CODE )VW where  process_type = $SQ$OP$SQ$$AND   order by  npsst_id$DQ$,$DQ$215$DQ$,$DQ$1$DQ$,$DQ$DEFAULT$DQ$,$DQ$DT_1304_1665901130705$DQ$,$DQ$DTT_1304_1665901217208$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$$DQ$,$DQ$WF_SELECT$DQ$,$DQ${}$DQ$,$DQ$DEFAULT$DQ$,$DQ$UICGC_1$DQ$] }",
  "qry_type": "I"
}]